"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const config_1 = require("../config");
class api {
    constructor() {
        this.url = config_1.urlRequest + "/api/wx/";
        this.token = "";
    }
    async login(data) {
        const el = await this.RequestUart({ url: "code2Session", data });
        if (el.ok) {
            this.token = el.arg.token;
            wx.setBackgroundFetchToken({
                token: this.token
            });
            wx.setStorage({ key: 'token', data: el.arg.token });
            const ws = wx.connectSocket({
                url: config_1.urlWs,
                header: {
                    'content-type': 'application/json'
                }
            });
            ws.onOpen(() => {
                ws.send({
                    data: JSON.stringify({ token: el.arg.token }),
                    success: () => {
                        this.wsInter = setInterval(() => {
                            ws.send({ data: 'time' });
                        }, 1000 * 30);
                    }
                });
                ws.onMessage((msg) => {
                    wx.vibrateLong();
                    wx.showModal({
                        title: '新的告警信息',
                        content: msg.data.toString(),
                        success() {
                            wx.switchTab({
                                url: '/pages/index/alarm/alarm'
                            });
                        }
                    });
                });
                wx.onSocketClose(() => {
                    console.log(new Date().toLocaleString() + "socket close");
                    clearInterval(this.wsInter);
                });
            });
        }
        return el;
    }
    userlogin(data) {
        return this.RequestUart({ url: 'userlogin', data });
    }
    updateAvanter(nickName, avanter) {
        return this.RequestUart({ url: 'updateAvanter', data: { nickName, avanter } });
    }
    async unbindwx() {
        const el = await this.RequestUart({ url: 'unbindwx', data: {} });
        this.token = "";
        return el;
    }
    getphonenumber(data) {
        return this.RequestUart({ url: "getphonenumber", data });
    }
    registerUser(data) {
        return this.RequestUart({ url: "register", data });
    }
    getuserMountDev() {
        return this.RequestUart({ url: 'getuserMountDev', data: {} });
    }
    getDTUInfo(mac) {
        return this.RequestUart({ url: 'getDTUInfo', data: { mac } });
    }
    getUserInfo() {
        return this.RequestUart({ url: 'getUserInfo', data: {} });
    }
    bindDev(mac) {
        return this.RequestUart({ url: 'bindDev', data: { mac } });
    }
    getAlarmunconfirmed() {
        return this.RequestUart({ url: 'getAlarmunconfirmed', data: {} });
    }
    getAlarm(start, end) {
        return this.RequestUart({ url: 'getAlarm', data: { start, end } });
    }
    alarmConfirmed(id) {
        return this.RequestUart({ url: 'alarmConfirmed', data: id ? { id } : {} });
    }
    getDevsRunInfo(mac, pid) {
        return this.RequestUart({ url: "getDevsRunInfo", data: { mac, pid } });
    }
    getDevsHistoryInfo(mac, pid, name, datatime = '') {
        return this.RequestUart({ url: 'getDevsHistoryInfo', data: { mac, pid, name, datatime } });
    }
    getDevOprate(protocol) {
        return this.RequestUart({ url: 'getDevOprate', data: { protocol } });
    }
    SendProcotolInstructSet(query, item) {
        return this.RequestUart({ url: 'SendProcotolInstructSet', data: { query, item }, method: 'POST' });
    }
    getUserDevConstant(protocol) {
        return this.RequestUart({ url: 'getUserDevConstant', data: { protocol } });
    }
    pushThreshold(arg, type, Protocol) {
        return this.RequestUart({ url: "pushThreshold", data: { type, arg, Protocol }, method: "POST" });
    }
    getUserAlarmTels() {
        return this.RequestUart({ url: 'getUserAlarmTels', data: {} });
    }
    setUserSetupContact(tels, mails) {
        return this.RequestUart({ url: 'setUserSetupContact', data: { tels, mails }, method: "POST" });
    }
    addTerminalMountDe(DevMac, Type, mountDev, protocol, pid) {
        return this.RequestUart({ url: 'addTerminalMountDev', data: { DevMac, Type, mountDev, protocol, pid }, method: "POST" });
    }
    delTerminalMountDev(DevMac, mountDev, pid) {
        return this.RequestUart({ url: 'delTerminalMountDev', data: { DevMac, mountDev, pid }, method: "POST" });
    }
    delUserTerminal(mac) {
        return this.RequestUart({ url: 'delUserTerminal', data: { mac } });
    }
    DevTypes(Type) {
        return this.RequestUart({ url: 'DevTypes', data: { Type } });
    }
    modifyUserInfo(type, value) {
        return this.RequestUart({ url: 'modifyUserInfo', data: { type, value } });
    }
    getGPSaddress(location) {
        return this.RequestUart({ url: 'getGPSaddress', data: { location } });
    }
    async cancelwx() {
        const el = await this.RequestUart({ url: 'cancelwx', data: {} });
        this.token = "";
        return el;
    }
    getUserTel() {
        return this.RequestUart({ url: 'getUserTel', data: {} });
    }
    sendValidation() {
        return this.RequestUart({ url: 'sendValidation', data: {} });
    }
    ValidationCode(code) {
        return this.RequestUart({ url: 'ValidationCode', data: { code } });
    }
    getNodes() {
        return this.RequestUart({ url: 'getNodes', data: {} });
    }
    bacthRegisterDTU(node, dtus) {
        return this.RequestUart({ url: 'bacthRegisterDTU', data: { node, dtus }, method: "POST" });
    }
    addVm() {
        return this.RequestUart({ url: 'addVm', data: {} });
    }
    modifyDTUName(dtu, name) {
        return this.RequestUart({ url: 'modifyDTUName', data: { dtu, name } });
    }
    updateGps(dtu, jw) {
        return this.RequestUart({ url: 'updateGps', data: { dtu, jw } });
    }
    webLogin(code) {
        return this.RequestUart({ url: 'webLogin', data: { code, token: this.token } });
    }
    iotRemoteUrl(mac) {
        return this.RequestUart({ url: 'iotRemoteUrl', data: { mac } });
    }
    async RequestUart(object) {
        const token = this.token || await wx.getStorage({ key: 'token' }).then(el => el.data).catch(() => "");
        return await new Promise((resolve, reject) => {
            wx.request({
                timeout: 1000 * 60,
                url: this.url + object.url,
                data: object.data,
                method: object.method || "GET",
                enableHttp2: true,
                header: { token: token },
                success: res => {
                    if (res.statusCode !== 200) {
                        wx.showToast({
                            title: String(res.statusCode),
                            content: res.data.toString() || res.errMsg,
                            success() {
                                wx.reLaunch({ url: '/pages/index/index' });
                            }
                        });
                        reject(res);
                    }
                    else {
                        setTimeout(() => {
                            resolve(res.data);
                        }, 0);
                    }
                },
                fail: e => {
                    wx.showModal({ title: '服务器错误', content: e.errMsg });
                    reject(e);
                },
                complete: () => {
                }
            });
        });
    }
}
exports.default = new api();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYXBpLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiYXBpLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7O0FBQUEsc0NBQTZDO0FBMkQ3QyxNQUFNLEdBQUc7SUFJUDtRQUNFLElBQUksQ0FBQyxHQUFHLEdBQUcsbUJBQVUsR0FBRyxVQUFVLENBQUE7UUFDbEMsSUFBSSxDQUFDLEtBQUssR0FBRyxFQUFFLENBQUE7SUFDakIsQ0FBQztJQU1ELEtBQUssQ0FBQyxLQUFLLENBQUMsSUFBeUI7UUFDbkMsTUFBTSxFQUFFLEdBQUcsTUFBTSxJQUFJLENBQUMsV0FBVyxDQUFNLEVBQUUsR0FBRyxFQUFFLGNBQWMsRUFBRSxJQUFJLEVBQUUsQ0FBQyxDQUFBO1FBQ3JFLElBQUksRUFBRSxDQUFDLEVBQUUsRUFBRTtZQUNULElBQUksQ0FBQyxLQUFLLEdBQUcsRUFBRSxDQUFDLEdBQUcsQ0FBQyxLQUFLLENBQUE7WUFDekIsRUFBRSxDQUFDLHVCQUF1QixDQUFDO2dCQUN6QixLQUFLLEVBQUUsSUFBSSxDQUFDLEtBQUs7YUFDbEIsQ0FBQyxDQUFBO1lBQ0YsRUFBRSxDQUFDLFVBQVUsQ0FBQyxFQUFFLEdBQUcsRUFBRSxPQUFPLEVBQUUsSUFBSSxFQUFFLEVBQUUsQ0FBQyxHQUFHLENBQUMsS0FBSyxFQUFFLENBQUMsQ0FBQTtZQUVuRCxNQUFNLEVBQUUsR0FBRyxFQUFFLENBQUMsYUFBYSxDQUFDO2dCQUMxQixHQUFHLEVBQUUsY0FBSztnQkFDVixNQUFNLEVBQUU7b0JBQ04sY0FBYyxFQUFFLGtCQUFrQjtpQkFDbkM7YUFDRixDQUFDLENBQUE7WUFDRixFQUFFLENBQUMsTUFBTSxDQUFDLEdBQUcsRUFBRTtnQkFDYixFQUFFLENBQUMsSUFBSSxDQUFDO29CQUNOLElBQUksRUFBRSxJQUFJLENBQUMsU0FBUyxDQUFDLEVBQUUsS0FBSyxFQUFFLEVBQUUsQ0FBQyxHQUFHLENBQUMsS0FBZSxFQUFFLENBQUM7b0JBQ3ZELE9BQU8sRUFBRSxHQUFHLEVBQUU7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Q0FBQyxDQUFDLENBQUE7SUFDSixDQUFDO0NBQ0Y7QUFFRCxrQkFBZSxJQUFJLEdBQUcsRUFBRSxDQUFBIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgdXJsUmVxdWVzdCwgdXJsV3MgfSBmcm9tIFwiLi4vY29uZmlnXCJcblxuaW50ZXJmYWNlIHRlbmNldE1hcCB7XG4gIC8qIOeKtuaAgeegge+8jDDkuLrmraPluLgsXG4zMTDor7fmsYLlj4LmlbDkv6Hmga/mnInor6/vvIxcbjMxMUtleeagvOW8j+mUmeivryxcbjMwNuivt+axguacieaKpOaMgeS/oeaBr+ivt+ajgOafpeWtl+espuS4sixcbjExMOivt+axguadpea6kOacquiiq+aOiOadgyAqL1xuICBzdGF0dXM6IG51bWJlcixcbiAgcmVxdWVzdF9pZDogc3RyaW5nLFxuICBtZXNzYWdlOiBzdHJpbmdcbiAgcmVzdWx0OiBhbnlcbn1cblxuLyoqXG4gKiBhcGnor7fmsYLot6/lvoRcbiAqL1xudHlwZSB1cmwgPSAnZ2V0dXNlck1vdW50RGV2J1xuICB8ICdjb2RlMlNlc3Npb24nXG4gIHwgJ2dldHBob25lbnVtYmVyJ1xuICB8ICdyZWdpc3RlcidcbiAgfCAnZ2V0RFRVSW5mbydcbiAgfCAnYmluZERldidcbiAgfCAnZ2V0QWxhcm0nXG4gIHwgJ2dldERldnNSdW5JbmZvJ1xuICB8ICdnZXREZXZzSGlzdG9yeUluZm8nXG4gIHwgJ3VzZXJsb2dpbidcbiAgfCAnZ2V0VXNlckluZm8nXG4gIHwgJ3VuYmluZHd4J1xuICB8ICdnZXRBbGFybXVuY29uZmlybWVkJ1xuICB8ICdhbGFybUNvbmZpcm1lZCdcbiAgfCAnZ2V0RGV2T3ByYXRlJ1xuICB8ICdTZW5kUHJvY290b2xJbnN0cnVjdFNldCdcbiAgfCAnZ2V0VXNlckRldkNvbnN0YW50J1xuICB8ICdwdXNoVGhyZXNob2xkJ1xuICB8ICdnZXRVc2VyQWxhcm1UZWxzJ1xuICB8ICdzZXRVc2VyU2V0dXBDb250YWN0J1xuICB8ICdhZGRUZXJtaW5hbE1vdW50RGV2J1xuICB8ICdkZWxUZXJtaW5hbE1vdW50RGV2J1xuICB8ICdkZWxVc2VyVGVybWluYWwnXG4gIHwgJ0RldlR5cGVzJ1xuICB8ICdtb2RpZnlVc2VySW5mbydcbiAgfCAnZ2V0R1BTYWRkcmVzcydcbiAgfCAnY2FuY2Vsd3gnXG4gIHwgJ2dldFVzZXJUZWwnXG4gIHwgJ3NlbmRWYWxpZGF0aW9uJ1xuICB8ICdWYWxpZGF0aW9uQ29kZSdcbiAgfCAnZ2V0Tm9kZXMnXG4gIHwgJ2JhY3RoUmVnaXN0ZXJEVFUnXG4gIHwgJ2FkZFZtJ1xuICB8ICdtb2RpZnlEVFVOYW1lJ1xuICB8ICd1cGRhdGVHcHMnXG4gIHwgJ3dlYkxvZ2luJ1xuICB8ICdpb3RSZW1vdGVVcmwnXG4gIHwgJ3VwZGF0ZUF2YW50ZXInXG5cbi8qKlxuICogQGNsYXNzIHdw5a6i5oi356uv57uf5LiA6K+35rGCYXBpXG4gKi9cbmNsYXNzIGFwaSB7XG4gIHJlYWRvbmx5IHVybDogc3RyaW5nXG4gIHRva2VuOiBzdHJpbmdcbiAgcHJpdmF0ZSB3c0ludGVyPzogbnVtYmVyXG4gIGNvbnN0cnVjdG9yKCkge1xuICAgIHRoaXMudXJsID0gdXJsUmVxdWVzdCArIFwiL2FwaS93eC9cIlxuICAgIHRoaXMudG9rZW4gPSBcIlwiXG4gIH1cblxuICAvKipcbiAgICog55m75b2VLSDln5/lkI1cbiAgICogQHBhcmFtIGRhdGEgXG4gICAqL1xuICBhc3luYyBsb2dpbihkYXRhOiB7IGpzX2NvZGU6IHN0cmluZyB9KSB7XG4gICAgY29uc3QgZWwgPSBhd2FpdCB0aGlzLlJlcXVlc3RVYXJ0PGFueT4oeyB1cmw6IFwiY29kZTJTZXNzaW9uXCIsIGRhdGEgfSlcbiAgICBpZiAoZWwub2spIHtcbiAgICAgIHRoaXMudG9rZW4gPSBlbC5hcmcudG9rZW5cbiAgICAgIHd4LnNldEJhY2tncm91bmRGZXRjaFRva2VuKHtcbiAgICAgICAgdG9rZW46IHRoaXMudG9rZW5cbiAgICAgIH0pXG4gICAgICB3eC5zZXRTdG9yYWdlKHsga2V5OiAndG9rZW4nLCBkYXRhOiBlbC5hcmcudG9rZW4gfSlcbiAgICAgIC8vIOWQr+eUqHNvY2tldFxuICAgICAgY29uc3Qgd3MgPSB3eC5jb25uZWN0U29ja2V0KHtcbiAgICAgICAgdXJsOiB1cmxXcyxcbiAgICAgICAgaGVhZGVyOiB7XG4gICAgICAgICAgJ2NvbnRlbnQtdHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJ1xuICAgICAgICB9XG4gICAgICB9KVxuICAgICAgd3Mub25PcGVuKCgpID0+IHtcbiAgICAgICAgd3Muc2VuZCh7XG4gICAgICAgICAgZGF0YTogSlNPTi5zdHJpbmdpZnkoeyB0b2tlbjogZWwuYXJnLnRva2VuIGFzIHN0cmluZyB9KSxcbiAgICAgICAgICBzdWNjZXNzOiAoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLndzSW50ZXIgPSBzZXRJbnRlcnZhbCgoKSA9PiB7XG4gICAgICAgICAgICAgIHdzLnNlbmQoeyBkYXRhOiAndGltZScgfSlcbiAgICAgICAgICAgIH0sIDEwMDAgKiAzMClcbiAgICAgICAgICB9XG4gICAgICAgIH0pXG4gICAgICAgIHdzLm9uTWVzc2FnZSgobXNnKSA9PiB7XG4gICAgICAgICAgd3gudmlicmF0ZUxvbmcoKVxuICAgICAgICAgIHd4LnNob3dNb2RhbCh7XG4gICAgICAgICAgICB0aXRsZTogJ+aWsOeahOWRiuitpuS/oeaBrycsXG4gICAgICAgICAgICBjb250ZW50OiBtc2cuZGF0YS50b1N0cmluZygpLFxuICAgICAgICAgICAgc3VjY2VzcygpIHtcbiAgICAgICAgICAgICAgd3guc3dpdGNoVGFiKHtcbiAgICAgICAgICAgICAgICB1cmw6ICcvcGFnZXMvaW5kZXgvYWxhcm0vYWxhcm0nXG4gICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSlcbiAgICAgICAgfSlcbiAgICAgICAgd3gub25Tb2NrZXRDbG9zZSgoKSA9PiB7XG4gICAgICAgICAgY29uc29sZS5sb2cobmV3IERhdGUoKS50b0xvY2FsZVN0cmluZygpICsgXCJzb2NrZXQgY2xvc2VcIik7XG4gICAgICAgICAgY2xlYXJJbnRlcnZhbCh0aGlzLndzSW50ZXIpXG4gICAgICAgIH0pXG4gICAgICB9KVxuICAgIH1cbiAgICByZXR1cm4gZWxcbiAgfVxuXG4gIC8qKlxuICAgKiDnmbvlvZUt55So5LqO5bCP56iL5bqP55m75b2V6aG16Z2i55m75b2VXG4gICAqIEBwYXJhbSBkYXRhIFxuICAgKi9cbiAgdXNlcmxvZ2luKGRhdGE6IHsgb3BlbmlkOiBzdHJpbmcsIGF2YW50ZXI6IHN0cmluZywgdXNlcjogc3RyaW5nLCBwYXNzd2Q6IHN0cmluZyB9KSB7XG4gICAgcmV0dXJuIHRoaXMuUmVxdWVzdFVhcnQ8YW55Pih7IHVybDogJ3VzZXJsb2dpbicsIGRhdGEgfSlcbiAgfVxuXG4gIC8qKlxuICAgKiDmm7TmlrDnlKjmiLflpLTlg4/lkozmmLXnp7BcbiAgICogQHBhcmFtIG5pY2tOYW1lIOaYteensFxuICAgKiBAcGFyYW0gYXZhbnRlciDlpLTlg4/pk77mjqVcbiAgICovXG4gIHVwZGF0ZUF2YW50ZXIobmlja05hbWU6IHN0cmluZywgYXZhbnRlcjogc3RyaW5nKSB7XG4gICAgcmV0dXJuIHRoaXMuUmVxdWVzdFVhcnQ8Ym9vbGVhbj4oeyB1cmw6ICd1cGRhdGVBdmFudGVyJywgZGF0YTogeyBuaWNrTmFtZSwgYXZhbnRlciB9IH0pXG4gIH1cblxuICAvKipcbiAgICog55So5LqO6Kej57uR5b6u5L+h5ZKM6YCP5Lyg6LSm5Y+355qE57uR5a6a5YWz57O7XG4gICAqL1xuICBhc3luYyB1bmJpbmR3eCgpIHtcbiAgICBjb25zdCBlbCA9IGF3YWl0IHRoaXMuUmVxdWVzdFVhcnQ8YW55Pih7IHVybDogJ3VuYmluZHd4JywgZGF0YToge30gfSlcbiAgICB0aGlzLnRva2VuID0gXCJcIlxuICAgIHJldHVybiBlbFxuICB9XG5cbiAgLyoqXG4gICAqIOino+WvhueUteivneWtl+espuS4slxuICAgKiBAcGFyYW0gZGF0YSBcbiAgICovXG4gIGdldHBob25lbnVtYmVyPFQ+KGRhdGE6IHsgb3BlbmlkOiBzdHJpbmcsIGVuY3J5cHRlZERhdGE6IHN0cmluZywgaXY6IHN0cmluZyB9KSB7XG4gICAgcmV0dXJuIHRoaXMuUmVxdWVzdFVhcnQ8VD4oeyB1cmw6IFwiZ2V0cGhvbmVudW1iZXJcIiwgZGF0YSB9KVxuICB9XG5cbiAgLyoqXG4gICAqIOazqOWGjFxuICAgKiBAcGFyYW0gZGF0YSBcbiAgICovXG4gIHJlZ2lzdGVyVXNlcihkYXRhOiB7IHVzZXI6IHN0cmluZywgbmFtZTogc3RyaW5nLCB0ZWw6IHN0cmluZywgYXZhbnRlcjogc3RyaW5nIH0pIHtcbiAgICByZXR1cm4gdGhpcy5SZXF1ZXN0VWFydCh7IHVybDogXCJyZWdpc3RlclwiLCBkYXRhIH0pXG4gIH1cblxuICAvKipcbiAgICog6I635Y+W55So5oi357uR5a6a6K6+5aSHXG4gICAqL1xuICBnZXR1c2VyTW91bnREZXYoKSB7XG4gICAgcmV0dXJuIHRoaXMuUmVxdWVzdFVhcnQ8eyBVVHM6IFRlcm1pbmFsW10gfT4oeyB1cmw6ICdnZXR1c2VyTW91bnREZXYnLCBkYXRhOiB7fSB9KVxuICB9XG5cbiAgLyoqXG4gICAqIOiOt+WPlkRUVeS/oeaBr1xuICAgKiBAcGFyYW0gbWFjIFxuICAgKi9cbiAgZ2V0RFRVSW5mbyhtYWM6IHN0cmluZykge1xuICAgIHJldHVybiB0aGlzLlJlcXVlc3RVYXJ0PFRlcm1pbmFsPih7IHVybDogJ2dldERUVUluZm8nLCBkYXRhOiB7IG1hYyB9IH0pXG4gIH1cblxuICAvKipcbiAgICog6I635Y+W55So5oi35L+h5oGvXG4gICAqL1xuICBnZXRVc2VySW5mbygpIHtcbiAgICByZXR1cm4gdGhpcy5SZXF1ZXN0VWFydDxVc2VySW5mbz4oeyB1cmw6ICdnZXRVc2VySW5mbycsIGRhdGE6IHt9IH0pXG4gIH1cblxuICAvKipcbiAgICog57uR5a6aRFRVXG4gICAqIEBwYXJhbSBtYWMgXG4gICAqL1xuICBiaW5kRGV2KG1hYzogc3RyaW5nKSB7XG4gICAgcmV0dXJuIHRoaXMuUmVxdWVzdFVhcnQ8YW55Pih7IHVybDogJ2JpbmREZXYnLCBkYXRhOiB7IG1hYyB9IH0pXG4gIH1cblxuICAvKipcbiAgICog6I635Y+W5pyq56Gu6K6k5ZGK6K2m5pWw6YePXG4gICAqL1xuICBnZXRBbGFybXVuY29uZmlybWVkKCkge1xuICAgIHJldHVybiB0aGlzLlJlcXVlc3RVYXJ0PHsgbGVuOiBudW1iZXIsIGFsYXJtOiB1YXJ0QWxhcm1PYmplY3RbXSB9Pih7IHVybDogJ2dldEFsYXJtdW5jb25maXJtZWQnLCBkYXRhOiB7fSB9KVxuICB9XG5cbiAgLyoqXG4gICAqIOiOt+WPluWRiuitpuS/oeaBr1xuICAgKiBAcGFyYW0gc3RhcnQgXG4gICAqIEBwYXJhbSBlbmQgXG4gICAqL1xuICBnZXRBbGFybShzdGFydDogc3RyaW5nLCBlbmQ6IHN0cmluZykge1xuICAgIHJldHVybiB0aGlzLlJlcXVlc3RVYXJ0PHVhcnRBbGFybU9iamVjdFtdPih7IHVybDogJ2dldEFsYXJtJywgZGF0YTogeyBzdGFydCwgZW5kIH0gfSlcbiAgfVxuXG4gIC8qKlxuICAgKiDnoa7orqTlkYrorabkv6Hmga8s5pu05pawYmFyXG4gICAqIEBwYXJhbSBpZCBcbiAgICovXG4gIGFsYXJtQ29uZmlybWVkKGlkPzogc3RyaW5nKSB7XG4gICAgcmV0dXJuIHRoaXMuUmVxdWVzdFVhcnQoeyB1cmw6ICdhbGFybUNvbmZpcm1lZCcsIGRhdGE6IGlkID8geyBpZCB9IDoge30gfSlcbiAgfVxuXG4gIC8qKlxuICAgKiDojrflj5borr7lpIflrp7ml7bov5DooYzkv6Hmga9cbiAgICogQHBhcmFtIG1hYyBcbiAgICogQHBhcmFtIHBpZCBcbiAgICovXG4gIGdldERldnNSdW5JbmZvKG1hYzogc3RyaW5nLCBwaWQ6IHN0cmluZykge1xuICAgIHJldHVybiB0aGlzLlJlcXVlc3RVYXJ0PHF1ZXJ5UmVzdWx0Pih7IHVybDogXCJnZXREZXZzUnVuSW5mb1wiLCBkYXRhOiB7IG1hYywgcGlkIH0gfSlcbiAgfVxuXG4gIC8qKlxuICAgKiDojrflj5borr7lpIfljoblj7Lov5DooYzmlbDmja5cbiAgICogQHBhcmFtIG1hYyBcbiAgICogQHBhcmFtIHBpZCBcbiAgICogQHBhcmFtIG5hbWUgXG4gICAqIEBwYXJhbSBkYXRhdGltZSBcbiAgICovXG4gIGdldERldnNIaXN0b3J5SW5mbyhtYWM6IHN0cmluZywgcGlkOiBzdHJpbmcsIG5hbWU6IHN0cmluZywgZGF0YXRpbWU6IHN0cmluZyA9ICcnKSB7XG4gICAgcmV0dXJuIHRoaXMuUmVxdWVzdFVhcnQ8YW55Pih7IHVybDogJ2dldERldnNIaXN0b3J5SW5mbycsIGRhdGE6IHsgbWFjLCBwaWQsIG5hbWUsIGRhdGF0aW1lIH0gfSlcbiAgfVxuXG4gIC8qKlxuICAgKiDojrflj5borr7lpIfmk43mjqfmjIfku6RcbiAgICogQHBhcmFtIHByb3RvY29sIFxuICAgKi9cbiAgZ2V0RGV2T3ByYXRlKHByb3RvY29sOiBzdHJpbmcpIHtcbiAgICByZXR1cm4gdGhpcy5SZXF1ZXN0VWFydDxQaWNrPFByb3RvY29sQ29uc3RhbnRUaHJlc2hvbGQsICdPcHJhdGVJbnN0cnVjdCc+Pih7IHVybDogJ2dldERldk9wcmF0ZScsIGRhdGE6IHsgcHJvdG9jb2wgfSB9KVxuICB9XG5cbiAgLyoqXG4gICAqIOWbuuWumuWPkemAgeiuvuWkh+aTjeS9nOaMh+S7pFxuICAgKiBAcGFyYW0gcXVlcnkgXG4gICAqIEBwYXJhbSBpdGVtIFxuICAgKi9cbiAgU2VuZFByb2NvdG9sSW5zdHJ1Y3RTZXQocXVlcnk6IFBhcnRpYWw8aW5zdHJ1Y3RRdWVyeUFyZz4sIGl0ZW06IE9wcmF0ZUluc3RydWN0KSB7XG4gICAgcmV0dXJuIHRoaXMuUmVxdWVzdFVhcnQ8YW55Pih7IHVybDogJ1NlbmRQcm9jb3RvbEluc3RydWN0U2V0JywgZGF0YTogeyBxdWVyeSwgaXRlbSB9LCBtZXRob2Q6ICdQT1NUJyB9KVxuICB9XG5cbiAgLyoqXG4gICAqIOiOt+WPlueUqOaIt+iHquWumuS5ieWNj+iurumFjee9rlxuICAgKiBAcGFyYW0gcHJvdG9jb2wgXG4gICAqL1xuICBnZXRVc2VyRGV2Q29uc3RhbnQocHJvdG9jb2w6IHN0cmluZykge1xuICAgIHJldHVybiB0aGlzLlJlcXVlc3RVYXJ0PHsgdXNlcjogUHJvdG9jb2xDb25zdGFudFRocmVzaG9sZCwgc3lzOiBQcm90b2NvbENvbnN0YW50VGhyZXNob2xkLCBwcm90b2NvbDogcHJvdG9jb2wgfT4oeyB1cmw6ICdnZXRVc2VyRGV2Q29uc3RhbnQnLCBkYXRhOiB7IHByb3RvY29sIH0gfSlcbiAgfVxuXG4gIC8qKlxuICAgKiDnu5/kuIDmj5DkuqTphY3nva5cbiAgICogQHBhcmFtIGFyZyBcbiAgICogQHBhcmFtIHR5cGUgXG4gICAqIEBwYXJhbSBQcm90b2NvbCBcbiAgICovXG4gIHB1c2hUaHJlc2hvbGQoYXJnOiBDb25zdGFudEFsYXJtU3RhdFtdIHwgVGhyZXNob2xkW10gfCBzdHJpbmdbXSwgdHlwZTogQ29uc3RhbnRUaHJlc2hvbGRUeXBlLCBQcm90b2NvbDogc3RyaW5nKSB7XG4gICAgcmV0dXJuIHRoaXMuUmVxdWVzdFVhcnQ8YW55Pih7IHVybDogXCJwdXNoVGhyZXNob2xkXCIsIGRhdGE6IHsgdHlwZSwgYXJnLCBQcm90b2NvbCB9LCBtZXRob2Q6IFwiUE9TVFwiIH0pXG4gIH1cblxuICAvKipcbiAgICog6I635Y+W55So5oi355qE5ZGK6K2m6IGU57O75pa55byPXG4gICAqL1xuICBnZXRVc2VyQWxhcm1UZWxzKCkge1xuICAgIHJldHVybiB0aGlzLlJlcXVlc3RVYXJ0PFBpY2s8dXNlclNldHVwLCAnbWFpbHMnIHwgJ3RlbHMnPj4oeyB1cmw6ICdnZXRVc2VyQWxhcm1UZWxzJywgZGF0YToge30gfSlcbiAgfVxuXG4gIC8qKlxuICAgKiDorr7nva7nlKjmiLfnmoTlkYrorabogZTns7vmlrnlvI9cbiAgICogQHBhcmFtIHRlbHMgXG4gICAqIEBwYXJhbSBtYWlscyBcbiAgICovXG4gIHNldFVzZXJTZXR1cENvbnRhY3QodGVsczogc3RyaW5nW10sIG1haWxzOiBzdHJpbmdbXSkge1xuICAgIHJldHVybiB0aGlzLlJlcXVlc3RVYXJ0PGFueT4oeyB1cmw6ICdzZXRVc2VyU2V0dXBDb250YWN0JywgZGF0YTogeyB0ZWxzLCBtYWlscyB9LCBtZXRob2Q6IFwiUE9TVFwiIH0pXG4gIH1cblxuICAvKipcbiAgICog5re75YqgRFRV5oyC6L296K6+5aSHXG4gICAqIEBwYXJhbSBEZXZNYWMgXG4gICAqIEBwYXJhbSBUeXBlIFxuICAgKiBAcGFyYW0gbW91bnREZXYgXG4gICAqIEBwYXJhbSBwcm90b2NvbCBcbiAgICogQHBhcmFtIHBpZCBcbiAgICovXG4gIGFkZFRlcm1pbmFsTW91bnREZShEZXZNYWM6IHN0cmluZywgVHlwZTogc3RyaW5nLCBtb3VudERldjogc3RyaW5nLCBwcm90b2NvbDogc3RyaW5nLCBwaWQ6IHN0cmluZykge1xuICAgIHJldHVybiB0aGlzLlJlcXVlc3RVYXJ0PGFueT4oeyB1cmw6ICdhZGRUZXJtaW5hbE1vdW50RGV2JywgZGF0YTogeyBEZXZNYWMsIFR5cGUsIG1vdW50RGV2LCBwcm90b2NvbCwgcGlkIH0sIG1ldGhvZDogXCJQT1NUXCIgfSlcbiAgfVxuXG4gIC8qKlxuICAgKiDliKDpmaTnu4jnq6/mjILovb3orr7lpIdcbiAgICogQHBhcmFtIERldk1hYyDorr7lpIdtYWNcbiAgICogQHBhcmFtIG1vdW50RGV2IOaMgui9veiuvuWkh1xuICAgKiBAcGFyYW0gcGlkIFxuICAgKi9cbiAgZGVsVGVybWluYWxNb3VudERldihEZXZNYWM6IHN0cmluZywgbW91bnREZXY6IHN0cmluZywgcGlkOiBzdHJpbmcpIHtcbiAgICByZXR1cm4gdGhpcy5SZXF1ZXN0VWFydDxhbnk+KHsgdXJsOiAnZGVsVGVybWluYWxNb3VudERldicsIGRhdGE6IHsgRGV2TWFjLCBtb3VudERldiwgcGlkIH0sIG1ldGhvZDogXCJQT1NUXCIgfSlcbiAgfVxuXG4gIC8qKlxuICAgKiDliKDpmaTnlKjmiLfnu4jnq6/nu5HlrppcbiAgICogQHBhcmFtIG1hYyBcbiAgICovXG4gIGRlbFVzZXJUZXJtaW5hbChtYWM6IHN0cmluZykge1xuICAgIHJldHVybiB0aGlzLlJlcXVlc3RVYXJ0PGFueT4oeyB1cmw6ICdkZWxVc2VyVGVybWluYWwnLCBkYXRhOiB7IG1hYyB9IH0pXG4gIH1cblxuICAvKipcbiAgICog6I635Y+W6K6+5aSH57G75Z6LXG4gICAqIEBwYXJhbSBUeXBlIOiuvuWkh+exu+Wei+Wkp+exu1xuICAgKi9cbiAgRGV2VHlwZXMoVHlwZTogc3RyaW5nKSB7XG4gICAgcmV0dXJuIHRoaXMuUmVxdWVzdFVhcnQ8RGV2c1R5cGVbXT4oeyB1cmw6ICdEZXZUeXBlcycsIGRhdGE6IHsgVHlwZSB9IH0pXG4gIH1cblxuICAvKipcbiAgICog5L+u5pS555So5oi35L+h5oGvXG4gICAqIEBwYXJhbSB0eXBlIOS/ruaUueexu+Wei1xuICAgKiBAcGFyYW0gdmFsdWUg5YC8XG4gICAqL1xuICBtb2RpZnlVc2VySW5mbyh0eXBlOiAndGVsJyB8ICdtYWlsJyB8ICduYW1lJywgdmFsdWU6IHN0cmluZykge1xuICAgIHJldHVybiB0aGlzLlJlcXVlc3RVYXJ0PGFueT4oeyB1cmw6ICdtb2RpZnlVc2VySW5mbycsIGRhdGE6IHsgdHlwZSwgdmFsdWUgfSB9KVxuICB9XG5cbiAgLyoqXG4gICAqIOiOt+WPlmdwc+WumuS9jeeahOivpue7huWcsOWdgFxuICAgKiBAcGFyYW0gbG9jYXRpb24gXG4gICAqL1xuICBnZXRHUFNhZGRyZXNzKGxvY2F0aW9uOiBzdHJpbmcpIHtcbiAgICByZXR1cm4gdGhpcy5SZXF1ZXN0VWFydDx0ZW5jZXRNYXA+KHsgdXJsOiAnZ2V0R1BTYWRkcmVzcycsIGRhdGE6IHsgbG9jYXRpb24gfSB9KVxuICB9XG5cbiAgLyoqXG4gICAqIOazqOmUgOW+ruS/oVxuICAgKi9cbiAgYXN5bmMgY2FuY2Vsd3goKSB7XG4gICAgY29uc3QgZWwgPSBhd2FpdCB0aGlzLlJlcXVlc3RVYXJ0PHN0cmluZz4oeyB1cmw6ICdjYW5jZWx3eCcsIGRhdGE6IHt9IH0pXG4gICAgdGhpcy50b2tlbiA9IFwiXCJcbiAgICByZXR1cm4gZWxcbiAgfVxuXG4gIC8qKlxuICAgKiDojrflj5bnlKjmiLfmiYvmnLrlj7fnoIFcbiAgICovXG4gIGdldFVzZXJUZWwoKSB7XG4gICAgcmV0dXJuIHRoaXMuUmVxdWVzdFVhcnQ8c3RyaW5nPih7IHVybDogJ2dldFVzZXJUZWwnLCBkYXRhOiB7fSB9KVxuICB9XG5cbiAgLyoqXG4gICAqIOWPkemAgeefreS/oemqjOivgeeggVxuICAgKi9cbiAgc2VuZFZhbGlkYXRpb24oKSB7XG4gICAgcmV0dXJuIHRoaXMuUmVxdWVzdFVhcnQ8c3RyaW5nPih7IHVybDogJ3NlbmRWYWxpZGF0aW9uJywgZGF0YToge30gfSlcbiAgfVxuXG4gIC8qKlxuICAgKiDmo4Dpqoznn63kv6Hpqozor4HnoIFcbiAgICogQHBhcmFtIGNvZGUg6aqM6K+B56CBXG4gICAqL1xuICBWYWxpZGF0aW9uQ29kZShjb2RlOiBudW1iZXIpIHtcbiAgICByZXR1cm4gdGhpcy5SZXF1ZXN0VWFydDxzdHJpbmc+KHsgdXJsOiAnVmFsaWRhdGlvbkNvZGUnLCBkYXRhOiB7IGNvZGUgfSB9KVxuICB9XG5cbiAgLyoqXG4gICAqIOiOt+WPluiKgueCueWIl+ihqFxuICAgKi9cbiAgZ2V0Tm9kZXMoKSB7XG4gICAgcmV0dXJuIHRoaXMuUmVxdWVzdFVhcnQ8Tm9kZUNsaWVudFtdPih7IHVybDogJ2dldE5vZGVzJywgZGF0YToge30gfSlcbiAgfVxuXG4gIC8qKlxuICAgKiDmibnph4/ms6jlhoxEVFVcbiAgICogQHBhcmFtIG5vZGUg6IqC54K55ZCN56ewXG4gICAqIEBwYXJhbSBkdHVzIGR0dU1hY+aVsOe7hFxuICAgKi9cbiAgYmFjdGhSZWdpc3RlckRUVShub2RlOiBzdHJpbmcsIGR0dXM6IHN0cmluZ1tdKSB7XG4gICAgcmV0dXJuIHRoaXMuUmVxdWVzdFVhcnQ8c3RyaW5nPih7IHVybDogJ2JhY3RoUmVnaXN0ZXJEVFUnLCBkYXRhOiB7IG5vZGUsIGR0dXMgfSwgbWV0aG9kOiBcIlBPU1RcIiB9KVxuICB9XG5cbiAgLyoqXG4gICAqIOa3u+WKoOiZmuaLn+iuvuWkh1xuICAgKi9cbiAgYWRkVm0oKSB7XG4gICAgcmV0dXJuIHRoaXMuUmVxdWVzdFVhcnQ8VGVybWluYWxbXT4oeyB1cmw6ICdhZGRWbScsIGRhdGE6IHt9IH0pXG4gIH1cblxuICAvKipcbiAgICog5L+u5pS5RFRV5ZCN56ewXG4gICAqIEBwYXJhbSBkdHUgbWFjXG4gICAqIEBwYXJhbSBuYW1lIOaWsOeahOWQjeensFxuICAgKi9cbiAgbW9kaWZ5RFRVTmFtZShkdHU6IHN0cmluZywgbmFtZTogc3RyaW5nKSB7XG4gICAgcmV0dXJuIHRoaXMuUmVxdWVzdFVhcnQ8c3RyaW5nPih7IHVybDogJ21vZGlmeURUVU5hbWUnLCBkYXRhOiB7IGR0dSwgbmFtZSB9IH0pXG4gIH1cblxuICAvKipcbiAgICog5pu05pawZHR15a6a5L2NXG4gICAqIEBwYXJhbSBkdHUgZHR1TWFjXG4gICAqIEBwYXJhbSBqdyDnu4/nuqzluqZcbiAgICovXG4gIHVwZGF0ZUdwcyhkdHU6IHN0cmluZywganc6IHN0cmluZykge1xuICAgIHJldHVybiB0aGlzLlJlcXVlc3RVYXJ0PHN0cmluZz4oeyB1cmw6ICd1cGRhdGVHcHMnLCBkYXRhOiB7IGR0dSwgancgfSB9KVxuICB9XG5cbiAgLyoqXG4gICAqIHdlYueZu+W9lVxuICAgKiBAcGFyYW0gY29kZSB0b2tlblxuICAgKi9cbiAgd2ViTG9naW4oY29kZTogc3RyaW5nKSB7XG4gICAgcmV0dXJuIHRoaXMuUmVxdWVzdFVhcnQ8c3RyaW5nPih7IHVybDogJ3dlYkxvZ2luJywgZGF0YTogeyBjb2RlLCB0b2tlbjogdGhpcy50b2tlbiB9IH0pXG4gIH1cblxuICAvKipcbiAgICog6I635Y+WZHR16L+c56iL6LCD6K+V572R5Z2AXG4gICAqIEBwYXJhbSBtYWMgXG4gICAqL1xuICBpb3RSZW1vdGVVcmwobWFjOiBzdHJpbmcpIHtcbiAgICByZXR1cm4gdGhpcy5SZXF1ZXN0VWFydDxzdHJpbmc+KHsgdXJsOiAnaW90UmVtb3RlVXJsJywgZGF0YTogeyBtYWMgfSB9KVxuICB9XG5cbiAgLyoqXG4gICAqIEBtZXRob2QgYXBp6YCa55SocmVxdXN05pa55rOVXG4gICAqIEBwYXJhbSBvYmplY3QgXG4gICAqL1xuICBwcml2YXRlIGFzeW5jIFJlcXVlc3RVYXJ0PFQ+KG9iamVjdDogeyB1cmw6IHVybCwgZGF0YTogT2JqZWN0LCBtZXRob2Q/OiBcIkdFVFwiIHwgXCJQT1NUXCIgfSkge1xuICAgIC8vd3guc2hvd0xvYWRpbmcoeyB0aXRsZTogJ+ato+WcqOafpeivoicgfSlcbiAgICAvLyB3eC5zaG93TmF2aWdhdGlvbkJhckxvYWRpbmcoKVxuICAgIGNvbnN0IHRva2VuOiBzdHJpbmcgPSB0aGlzLnRva2VuIHx8IGF3YWl0IHd4LmdldFN0b3JhZ2UoeyBrZXk6ICd0b2tlbicgfSkudGhlbihlbCA9PiBlbC5kYXRhKS5jYXRjaCgoKSA9PiBcIlwiKVxuICAgIHJldHVybiBhd2FpdCBuZXcgUHJvbWlzZTxBcG9sbG9Nb25nb1Jlc3VsdDxUPj4oKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgd3gucmVxdWVzdCh7XG4gICAgICAgIHRpbWVvdXQ6IDEwMDAgKiA2MCxcbiAgICAgICAgdXJsOiB0aGlzLnVybCArIG9iamVjdC51cmwsXG4gICAgICAgIGRhdGE6IG9iamVjdC5kYXRhLC8vT2JqZWN0LmFzc2lnbih7IHRva2VuOiB0b2tlbiB9LCBvYmplY3QuZGF0YSksXG4gICAgICAgIG1ldGhvZDogb2JqZWN0Lm1ldGhvZCB8fCBcIkdFVFwiLFxuICAgICAgICBlbmFibGVIdHRwMjp0cnVlLFxuICAgICAgICBcbiAgICAgICAgaGVhZGVyOiB7IHRva2VuOiB0b2tlbiB9LFxuICAgICAgICBzdWNjZXNzOiByZXMgPT4ge1xuICAgICAgICAgIC8vIGNvbnNvbGUubG9nKHJlcyk7XG4gICAgICAgICAgLy8gd3guaGlkZUxvYWRpbmcoKVxuICAgICAgICAgIGlmIChyZXMuc3RhdHVzQ29kZSAhPT0gMjAwKSB7XG4gICAgICAgICAgICB3eC5zaG93VG9hc3Qoe1xuICAgICAgICAgICAgICB0aXRsZTogU3RyaW5nKHJlcy5zdGF0dXNDb2RlKSxcbiAgICAgICAgICAgICAgY29udGVudDogcmVzLmRhdGEudG9TdHJpbmcoKSB8fCByZXMuZXJyTXNnLFxuICAgICAgICAgICAgICBzdWNjZXNzKCkge1xuICAgICAgICAgICAgICAgIHd4LnJlTGF1bmNoKHsgdXJsOiAnL3BhZ2VzL2luZGV4L2luZGV4JyB9KVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgcmVqZWN0KHJlcylcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgICAgIHJlc29sdmUocmVzLmRhdGEgYXMgYW55KVxuICAgICAgICAgICAgfSwgMClcbiAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIGZhaWw6IGUgPT4ge1xuICAgICAgICAgIHd4LnNob3dNb2RhbCh7IHRpdGxlOiAn5pyN5Yqh5Zmo6ZSZ6K+vJywgY29udGVudDogZS5lcnJNc2cgfSlcbiAgICAgICAgICAvLyB3eC5oaWRlTG9hZGluZygpXG4gICAgICAgICAgcmVqZWN0KGUpXG4gICAgICAgIH0sXG4gICAgICAgIGNvbXBsZXRlOiAoKSA9PiB7XG4gICAgICAgICAgLy8gd3guaGlkZU5hdmlnYXRpb25CYXJMb2FkaW5nKClcbiAgICAgICAgICAvLyB3eC5oaWRlTG9hZGluZygpXG4gICAgICAgIH1cbiAgICAgIH0pXG4gICAgfSlcbiAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBuZXcgYXBpKClcbiJdfQ==