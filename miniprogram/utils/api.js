"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const config_1 = require("../config");
class api {
    constructor() {
        this.url = config_1.urlRequest + "/api/wx/";
        this.token = "";
    }
    async login(data) {
        const el = await this.RequestUart({ url: "code2Session", data });
        if (el.ok) {
            this.token = el.arg.token;
            wx.setBackgroundFetchToken({
                token: this.token
            });
            wx.setStorage({ key: 'token', data: el.arg.token });
            const ws = wx.connectSocket({
                url: config_1.urlWs,
                header: {
                    'content-type': 'application/json'
                }
            });
            ws.onOpen(() => {
                ws.send({
                    data: JSON.stringify({ token: el.arg.token }),
                    success: () => {
                        this.wsInter = setInterval(() => {
                            ws.send({ data: 'time' });
                        }, 1000 * 30);
                    }
                });
                ws.onMessage((msg) => {
                    wx.vibrateLong();
                    wx.showModal({
                        title: '新的告警信息',
                        content: msg.data.toString(),
                        success() {
                            wx.switchTab({
                                url: '/pages/index/alarm/alarm'
                            });
                        }
                    });
                });
                wx.onSocketClose(() => {
                    console.log(new Date().toLocaleString() + "socket close");
                    clearInterval(this.wsInter);
                });
            });
        }
        return el;
    }
    userlogin(data) {
        return this.RequestUart({ url: 'userlogin', data });
    }
    updateAvanter(nickName, avanter) {
        return this.RequestUart({ url: 'updateAvanter', data: { nickName, avanter } });
    }
    async unbindwx() {
        const el = await this.RequestUart({ url: 'unbindwx', data: {} });
        this.token = "";
        return el;
    }
    getphonenumber(data) {
        return this.RequestUart({ url: "getphonenumber", data });
    }
    registerUser(data) {
        return this.RequestUart({ url: "register", data });
    }
    getuserMountDev() {
        return this.RequestUart({ url: 'getuserMountDev', data: {} });
    }
    getDTUInfo(mac) {
        return this.RequestUart({ url: 'getDTUInfo', data: { mac } });
    }
    getUserInfo() {
        return this.RequestUart({ url: 'getUserInfo', data: {} });
    }
    bindDev(mac) {
        return this.RequestUart({ url: 'bindDev', data: { mac } });
    }
    getAlarmunconfirmed() {
        return this.RequestUart({ url: 'getAlarmunconfirmed', data: {} });
    }
    getAlarm(start, end) {
        return this.RequestUart({ url: 'getAlarm', data: { start, end } });
    }
    alarmConfirmed(id) {
        return this.RequestUart({ url: 'alarmConfirmed', data: id ? { id } : {} });
    }
    getDevsRunInfo(mac, pid) {
        return this.RequestUart({ url: "getDevsRunInfo", data: { mac, pid } });
    }
    getDevsHistoryInfo(mac, pid, name, datatime = '') {
        return this.RequestUart({ url: 'getDevsHistoryInfo', data: { mac, pid, name, datatime } });
    }
    getDevOprate(protocol) {
        return this.RequestUart({ url: 'getDevOprate', data: { protocol } });
    }
    SendProcotolInstructSet(query, item) {
        return this.RequestUart({ url: 'SendProcotolInstructSet', data: { query, item }, method: 'POST' });
    }
    getUserDevConstant(protocol) {
        return this.RequestUart({ url: 'getUserDevConstant', data: { protocol } });
    }
    pushThreshold(arg, type, Protocol) {
        return this.RequestUart({ url: "pushThreshold", data: { type, arg, Protocol }, method: "POST" });
    }
    getUserAlarmTels() {
        return this.RequestUart({ url: 'getUserAlarmTels', data: {} });
    }
    setUserSetupContact(tels, mails) {
        return this.RequestUart({ url: 'setUserSetupContact', data: { tels, mails }, method: "POST" });
    }
    addTerminalMountDe(DevMac, Type, mountDev, protocol, pid) {
        return this.RequestUart({ url: 'addTerminalMountDev', data: { DevMac, Type, mountDev, protocol, pid }, method: "POST" });
    }
    delTerminalMountDev(DevMac, mountDev, pid) {
        return this.RequestUart({ url: 'delTerminalMountDev', data: { DevMac, mountDev, pid }, method: "POST" });
    }
    delUserTerminal(mac) {
        return this.RequestUart({ url: 'delUserTerminal', data: { mac } });
    }
    DevTypes(Type) {
        return this.RequestUart({ url: 'DevTypes', data: { Type } });
    }
    modifyUserInfo(type, value) {
        return this.RequestUart({ url: 'modifyUserInfo', data: { type, value } });
    }
    getGPSaddress(location) {
        return this.RequestUart({ url: 'getGPSaddress', data: { location } });
    }
    async cancelwx() {
        const el = await this.RequestUart({ url: 'cancelwx', data: {} });
        this.token = "";
        return el;
    }
    getUserTel() {
        return this.RequestUart({ url: 'getUserTel', data: {} });
    }
    sendValidation() {
        return this.RequestUart({ url: 'sendValidation', data: {} });
    }
    ValidationCode(code) {
        return this.RequestUart({ url: 'ValidationCode', data: { code } });
    }
    getNodes() {
        return this.RequestUart({ url: 'getNodes', data: {} });
    }
    bacthRegisterDTU(node, dtus) {
        return this.RequestUart({ url: 'bacthRegisterDTU', data: { node, dtus }, method: "POST" });
    }
    addVm() {
        return this.RequestUart({ url: 'addVm', data: {} });
    }
    modifyDTUName(dtu, name) {
        return this.RequestUart({ url: 'modifyDTUName', data: { dtu, name } });
    }
    updateGps(dtu, jw) {
        return this.RequestUart({ url: 'updateGps', data: { dtu, jw } });
    }
    webLogin(code) {
        return this.RequestUart({ url: 'webLogin', data: { code, token: this.token } });
    }
    iotRemoteUrl(mac) {
        return this.RequestUart({ url: 'iotRemoteUrl', data: { mac } });
    }
    async RequestUart(object) {
        const token = this.token || await wx.getStorage({ key: 'token' }).then(el => el.data).catch(() => "");
        return await new Promise((resolve, reject) => {
            wx.request({
                timeout: 1000 * 60,
                url: this.url + object.url,
                data: object.data,
                method: object.method || "GET",
                header: { token: token },
                success: res => {
                    if (res.statusCode !== 200) {
                        wx.showToast({
                            title: String(res.statusCode),
                            content: res.data.toString() || res.errMsg,
                            success() {
                                wx.reLaunch({ url: '/pages/index/index' });
                            }
                        });
                        reject(res);
                    }
                    else {
                        setTimeout(() => {
                            resolve(res.data);
                        }, 0);
                    }
                },
                fail: e => {
                    wx.showModal({ title: '服务器错误', content: e.errMsg });
                    reject(e);
                },
                complete: () => {
                }
            });
        });
    }
}
exports.default = new api();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYXBpLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiYXBpLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7O0FBQUEsc0NBQTZDO0FBMkQ3QyxNQUFNLEdBQUc7SUFJUDtRQUNFLElBQUksQ0FBQyxHQUFHLEdBQUcsbUJBQVUsR0FBRyxVQUFVLENBQUE7UUFDbEMsSUFBSSxDQUFDLEtBQUssR0FBRyxFQUFFLENBQUE7SUFDakIsQ0FBQztJQU1ELEtBQUssQ0FBQyxLQUFLLENBQUMsSUFBeUI7UUFDbkMsTUFBTSxFQUFFLEdBQUcsTUFBTSxJQUFJLENBQUMsV0FBVyxDQUFNLEVBQUUsR0FBRyxFQUFFLGNBQWMsRUFBRSxJQUFJLEVBQUUsQ0FBQyxDQUFBO1FBQ3JFLElBQUksRUFBRSxDQUFDLEVBQUUsRUFBRTtZQUNULElBQUksQ0FBQyxLQUFLLEdBQUcsRUFBRSxDQUFDLEdBQUcsQ0FBQyxLQUFLLENBQUE7WUFDekIsRUFBRSxDQUFDLHVCQUF1QixDQUFDO2dCQUN6QixLQUFLLEVBQUUsSUFBSSxDQUFDLEtBQUs7YUFDbEIsQ0FBQyxDQUFBO1lBQ0YsRUFBRSxDQUFDLFVBQVUsQ0FBQyxFQUFFLEdBQUcsRUFBRSxPQUFPLEVBQUUsSUFBSSxFQUFFLEVBQUUsQ0FBQyxHQUFHLENBQUMsS0FBSyxFQUFFLENBQUMsQ0FBQTtZQUVuRCxNQUFNLEVBQUUsR0FBRyxFQUFFLENBQUMsYUFBYSxDQUFDO2dCQUMxQixHQUFHLEVBQUUsY0FBSztnQkFDVixNQUFNLEVBQUU7b0JBQ04sY0FBYyxFQUFFLGtCQUFrQjtpQkFDbkM7YUFDRixDQUFDLENBQUE7WUFDRixFQUFFLENBQUMsTUFBTSxDQUFDLEdBQUcsRUFBRTtnQkFDYixFQUFFLENBQUMsSUFBSSxDQUFDO29CQUNOLElBQUksRUFBRSxJQUFJLENBQUMsU0FBUyxDQUFDLEVBQUUsS0FBSyxFQUFFLEVBQUUsQ0FBQyxHQUFHLENBQUMsS0FBZSxFQUFFLENBQUM7b0JBQ3ZELE9BQU8sRUFBRSxHQUFHLEVBQUU7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QUM7Q0FDRjtBQUVELGtCQUFlLElBQUksR0FBRyxFQUFFLENBQUEiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyB1cmxSZXF1ZXN0LCB1cmxXcyB9IGZyb20gXCIuLi9jb25maWdcIlxuXG5pbnRlcmZhY2UgdGVuY2V0TWFwIHtcbiAgLyog54q25oCB56CB77yMMOS4uuato+W4uCxcbjMxMOivt+axguWPguaVsOS/oeaBr+acieivr++8jFxuMzExS2V55qC85byP6ZSZ6K+vLFxuMzA26K+35rGC5pyJ5oqk5oyB5L+h5oGv6K+35qOA5p+l5a2X56ym5LiyLFxuMTEw6K+35rGC5p2l5rqQ5pyq6KKr5o6I5p2DICovXG4gIHN0YXR1czogbnVtYmVyLFxuICByZXF1ZXN0X2lkOiBzdHJpbmcsXG4gIG1lc3NhZ2U6IHN0cmluZ1xuICByZXN1bHQ6IGFueVxufVxuXG4vKipcbiAqIGFwaeivt+axgui3r+W+hFxuICovXG50eXBlIHVybCA9ICdnZXR1c2VyTW91bnREZXYnXG4gIHwgJ2NvZGUyU2Vzc2lvbidcbiAgfCAnZ2V0cGhvbmVudW1iZXInXG4gIHwgJ3JlZ2lzdGVyJ1xuICB8ICdnZXREVFVJbmZvJ1xuICB8ICdiaW5kRGV2J1xuICB8ICdnZXRBbGFybSdcbiAgfCAnZ2V0RGV2c1J1bkluZm8nXG4gIHwgJ2dldERldnNIaXN0b3J5SW5mbydcbiAgfCAndXNlcmxvZ2luJ1xuICB8ICdnZXRVc2VySW5mbydcbiAgfCAndW5iaW5kd3gnXG4gIHwgJ2dldEFsYXJtdW5jb25maXJtZWQnXG4gIHwgJ2FsYXJtQ29uZmlybWVkJ1xuICB8ICdnZXREZXZPcHJhdGUnXG4gIHwgJ1NlbmRQcm9jb3RvbEluc3RydWN0U2V0J1xuICB8ICdnZXRVc2VyRGV2Q29uc3RhbnQnXG4gIHwgJ3B1c2hUaHJlc2hvbGQnXG4gIHwgJ2dldFVzZXJBbGFybVRlbHMnXG4gIHwgJ3NldFVzZXJTZXR1cENvbnRhY3QnXG4gIHwgJ2FkZFRlcm1pbmFsTW91bnREZXYnXG4gIHwgJ2RlbFRlcm1pbmFsTW91bnREZXYnXG4gIHwgJ2RlbFVzZXJUZXJtaW5hbCdcbiAgfCAnRGV2VHlwZXMnXG4gIHwgJ21vZGlmeVVzZXJJbmZvJ1xuICB8ICdnZXRHUFNhZGRyZXNzJ1xuICB8ICdjYW5jZWx3eCdcbiAgfCAnZ2V0VXNlclRlbCdcbiAgfCAnc2VuZFZhbGlkYXRpb24nXG4gIHwgJ1ZhbGlkYXRpb25Db2RlJ1xuICB8ICdnZXROb2RlcydcbiAgfCAnYmFjdGhSZWdpc3RlckRUVSdcbiAgfCAnYWRkVm0nXG4gIHwgJ21vZGlmeURUVU5hbWUnXG4gIHwgJ3VwZGF0ZUdwcydcbiAgfCAnd2ViTG9naW4nXG4gIHwgJ2lvdFJlbW90ZVVybCdcbiAgfCAndXBkYXRlQXZhbnRlcidcblxuLyoqXG4gKiBAY2xhc3Mgd3DlrqLmiLfnq6/nu5/kuIDor7fmsYJhcGlcbiAqL1xuY2xhc3MgYXBpIHtcbiAgcmVhZG9ubHkgdXJsOiBzdHJpbmdcbiAgdG9rZW46IHN0cmluZ1xuICBwcml2YXRlIHdzSW50ZXI/OiBudW1iZXJcbiAgY29uc3RydWN0b3IoKSB7XG4gICAgdGhpcy51cmwgPSB1cmxSZXF1ZXN0ICsgXCIvYXBpL3d4L1wiXG4gICAgdGhpcy50b2tlbiA9IFwiXCJcbiAgfVxuXG4gIC8qKlxuICAgKiDnmbvlvZUtIOWfn+WQjVxuICAgKiBAcGFyYW0gZGF0YSBcbiAgICovXG4gIGFzeW5jIGxvZ2luKGRhdGE6IHsganNfY29kZTogc3RyaW5nIH0pIHtcbiAgICBjb25zdCBlbCA9IGF3YWl0IHRoaXMuUmVxdWVzdFVhcnQ8YW55Pih7IHVybDogXCJjb2RlMlNlc3Npb25cIiwgZGF0YSB9KVxuICAgIGlmIChlbC5vaykge1xuICAgICAgdGhpcy50b2tlbiA9IGVsLmFyZy50b2tlblxuICAgICAgd3guc2V0QmFja2dyb3VuZEZldGNoVG9rZW4oe1xuICAgICAgICB0b2tlbjogdGhpcy50b2tlblxuICAgICAgfSlcbiAgICAgIHd4LnNldFN0b3JhZ2UoeyBrZXk6ICd0b2tlbicsIGRhdGE6IGVsLmFyZy50b2tlbiB9KVxuICAgICAgLy8g5ZCv55Soc29ja2V0XG4gICAgICBjb25zdCB3cyA9IHd4LmNvbm5lY3RTb2NrZXQoe1xuICAgICAgICB1cmw6IHVybFdzLFxuICAgICAgICBoZWFkZXI6IHtcbiAgICAgICAgICAnY29udGVudC10eXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nXG4gICAgICAgIH1cbiAgICAgIH0pXG4gICAgICB3cy5vbk9wZW4oKCkgPT4ge1xuICAgICAgICB3cy5zZW5kKHtcbiAgICAgICAgICBkYXRhOiBKU09OLnN0cmluZ2lmeSh7IHRva2VuOiBlbC5hcmcudG9rZW4gYXMgc3RyaW5nIH0pLFxuICAgICAgICAgIHN1Y2Nlc3M6ICgpID0+IHtcbiAgICAgICAgICAgIHRoaXMud3NJbnRlciA9IHNldEludGVydmFsKCgpID0+IHtcbiAgICAgICAgICAgICAgd3Muc2VuZCh7IGRhdGE6ICd0aW1lJyB9KVxuICAgICAgICAgICAgfSwgMTAwMCAqIDMwKVxuICAgICAgICAgIH1cbiAgICAgICAgfSlcbiAgICAgICAgd3Mub25NZXNzYWdlKChtc2cpID0+IHtcbiAgICAgICAgICB3eC52aWJyYXRlTG9uZygpXG4gICAgICAgICAgd3guc2hvd01vZGFsKHtcbiAgICAgICAgICAgIHRpdGxlOiAn5paw55qE5ZGK6K2m5L+h5oGvJyxcbiAgICAgICAgICAgIGNvbnRlbnQ6IG1zZy5kYXRhLnRvU3RyaW5nKCksXG4gICAgICAgICAgICBzdWNjZXNzKCkge1xuICAgICAgICAgICAgICB3eC5zd2l0Y2hUYWIoe1xuICAgICAgICAgICAgICAgIHVybDogJy9wYWdlcy9pbmRleC9hbGFybS9hbGFybSdcbiAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KVxuICAgICAgICB9KVxuICAgICAgICB3eC5vblNvY2tldENsb3NlKCgpID0+IHtcbiAgICAgICAgICBjb25zb2xlLmxvZyhuZXcgRGF0ZSgpLnRvTG9jYWxlU3RyaW5nKCkgKyBcInNvY2tldCBjbG9zZVwiKTtcbiAgICAgICAgICBjbGVhckludGVydmFsKHRoaXMud3NJbnRlcilcbiAgICAgICAgfSlcbiAgICAgIH0pXG4gICAgfVxuICAgIHJldHVybiBlbFxuICB9XG5cbiAgLyoqXG4gICAqIOeZu+W9lS3nlKjkuo7lsI/nqIvluo/nmbvlvZXpobXpnaLnmbvlvZVcbiAgICogQHBhcmFtIGRhdGEgXG4gICAqL1xuICB1c2VybG9naW4oZGF0YTogeyBvcGVuaWQ6IHN0cmluZywgYXZhbnRlcjogc3RyaW5nLCB1c2VyOiBzdHJpbmcsIHBhc3N3ZDogc3RyaW5nIH0pIHtcbiAgICByZXR1cm4gdGhpcy5SZXF1ZXN0VWFydDxhbnk+KHsgdXJsOiAndXNlcmxvZ2luJywgZGF0YSB9KVxuICB9XG5cbiAgLyoqXG4gICAqIOabtOaWsOeUqOaIt+WktOWDj+WSjOaYteensFxuICAgKiBAcGFyYW0gbmlja05hbWUg5pi156ewXG4gICAqIEBwYXJhbSBhdmFudGVyIOWktOWDj+mTvuaOpVxuICAgKi9cbiAgdXBkYXRlQXZhbnRlcihuaWNrTmFtZTogc3RyaW5nLCBhdmFudGVyOiBzdHJpbmcpIHtcbiAgICByZXR1cm4gdGhpcy5SZXF1ZXN0VWFydDxib29sZWFuPih7IHVybDogJ3VwZGF0ZUF2YW50ZXInLCBkYXRhOiB7IG5pY2tOYW1lLCBhdmFudGVyIH0gfSlcbiAgfVxuXG4gIC8qKlxuICAgKiDnlKjkuo7op6Pnu5Hlvq7kv6HlkozpgI/kvKDotKblj7fnmoTnu5HlrprlhbPns7tcbiAgICovXG4gIGFzeW5jIHVuYmluZHd4KCkge1xuICAgIGNvbnN0IGVsID0gYXdhaXQgdGhpcy5SZXF1ZXN0VWFydDxhbnk+KHsgdXJsOiAndW5iaW5kd3gnLCBkYXRhOiB7fSB9KVxuICAgIHRoaXMudG9rZW4gPSBcIlwiXG4gICAgcmV0dXJuIGVsXG4gIH1cblxuICAvKipcbiAgICog6Kej5a+G55S16K+d5a2X56ym5LiyXG4gICAqIEBwYXJhbSBkYXRhIFxuICAgKi9cbiAgZ2V0cGhvbmVudW1iZXI8VD4oZGF0YTogeyBvcGVuaWQ6IHN0cmluZywgZW5jcnlwdGVkRGF0YTogc3RyaW5nLCBpdjogc3RyaW5nIH0pIHtcbiAgICByZXR1cm4gdGhpcy5SZXF1ZXN0VWFydDxUPih7IHVybDogXCJnZXRwaG9uZW51bWJlclwiLCBkYXRhIH0pXG4gIH1cblxuICAvKipcbiAgICog5rOo5YaMXG4gICAqIEBwYXJhbSBkYXRhIFxuICAgKi9cbiAgcmVnaXN0ZXJVc2VyKGRhdGE6IHsgdXNlcjogc3RyaW5nLCBuYW1lOiBzdHJpbmcsIHRlbDogc3RyaW5nLCBhdmFudGVyOiBzdHJpbmcgfSkge1xuICAgIHJldHVybiB0aGlzLlJlcXVlc3RVYXJ0KHsgdXJsOiBcInJlZ2lzdGVyXCIsIGRhdGEgfSlcbiAgfVxuXG4gIC8qKlxuICAgKiDojrflj5bnlKjmiLfnu5Hlrprorr7lpIdcbiAgICovXG4gIGdldHVzZXJNb3VudERldigpIHtcbiAgICByZXR1cm4gdGhpcy5SZXF1ZXN0VWFydDx7IFVUczogVGVybWluYWxbXSB9Pih7IHVybDogJ2dldHVzZXJNb3VudERldicsIGRhdGE6IHt9IH0pXG4gIH1cblxuICAvKipcbiAgICog6I635Y+WRFRV5L+h5oGvXG4gICAqIEBwYXJhbSBtYWMgXG4gICAqL1xuICBnZXREVFVJbmZvKG1hYzogc3RyaW5nKSB7XG4gICAgcmV0dXJuIHRoaXMuUmVxdWVzdFVhcnQ8VGVybWluYWw+KHsgdXJsOiAnZ2V0RFRVSW5mbycsIGRhdGE6IHsgbWFjIH0gfSlcbiAgfVxuXG4gIC8qKlxuICAgKiDojrflj5bnlKjmiLfkv6Hmga9cbiAgICovXG4gIGdldFVzZXJJbmZvKCkge1xuICAgIHJldHVybiB0aGlzLlJlcXVlc3RVYXJ0PFVzZXJJbmZvPih7IHVybDogJ2dldFVzZXJJbmZvJywgZGF0YToge30gfSlcbiAgfVxuXG4gIC8qKlxuICAgKiDnu5HlrppEVFVcbiAgICogQHBhcmFtIG1hYyBcbiAgICovXG4gIGJpbmREZXYobWFjOiBzdHJpbmcpIHtcbiAgICByZXR1cm4gdGhpcy5SZXF1ZXN0VWFydDxhbnk+KHsgdXJsOiAnYmluZERldicsIGRhdGE6IHsgbWFjIH0gfSlcbiAgfVxuXG4gIC8qKlxuICAgKiDojrflj5bmnKrnoa7orqTlkYrorabmlbDph49cbiAgICovXG4gIGdldEFsYXJtdW5jb25maXJtZWQoKSB7XG4gICAgcmV0dXJuIHRoaXMuUmVxdWVzdFVhcnQ8eyBsZW46IG51bWJlciwgYWxhcm06IHVhcnRBbGFybU9iamVjdFtdIH0+KHsgdXJsOiAnZ2V0QWxhcm11bmNvbmZpcm1lZCcsIGRhdGE6IHt9IH0pXG4gIH1cblxuICAvKipcbiAgICog6I635Y+W5ZGK6K2m5L+h5oGvXG4gICAqIEBwYXJhbSBzdGFydCBcbiAgICogQHBhcmFtIGVuZCBcbiAgICovXG4gIGdldEFsYXJtKHN0YXJ0OiBzdHJpbmcsIGVuZDogc3RyaW5nKSB7XG4gICAgcmV0dXJuIHRoaXMuUmVxdWVzdFVhcnQ8dWFydEFsYXJtT2JqZWN0W10+KHsgdXJsOiAnZ2V0QWxhcm0nLCBkYXRhOiB7IHN0YXJ0LCBlbmQgfSB9KVxuICB9XG5cbiAgLyoqXG4gICAqIOehruiupOWRiuitpuS/oeaBryzmm7TmlrBiYXJcbiAgICogQHBhcmFtIGlkIFxuICAgKi9cbiAgYWxhcm1Db25maXJtZWQoaWQ/OiBzdHJpbmcpIHtcbiAgICByZXR1cm4gdGhpcy5SZXF1ZXN0VWFydCh7IHVybDogJ2FsYXJtQ29uZmlybWVkJywgZGF0YTogaWQgPyB7IGlkIH0gOiB7fSB9KVxuICB9XG5cbiAgLyoqXG4gICAqIOiOt+WPluiuvuWkh+WunuaXtui/kOihjOS/oeaBr1xuICAgKiBAcGFyYW0gbWFjIFxuICAgKiBAcGFyYW0gcGlkIFxuICAgKi9cbiAgZ2V0RGV2c1J1bkluZm8obWFjOiBzdHJpbmcsIHBpZDogc3RyaW5nKSB7XG4gICAgcmV0dXJuIHRoaXMuUmVxdWVzdFVhcnQ8cXVlcnlSZXN1bHQ+KHsgdXJsOiBcImdldERldnNSdW5JbmZvXCIsIGRhdGE6IHsgbWFjLCBwaWQgfSB9KVxuICB9XG5cbiAgLyoqXG4gICAqIOiOt+WPluiuvuWkh+WOhuWPsui/kOihjOaVsOaNrlxuICAgKiBAcGFyYW0gbWFjIFxuICAgKiBAcGFyYW0gcGlkIFxuICAgKiBAcGFyYW0gbmFtZSBcbiAgICogQHBhcmFtIGRhdGF0aW1lIFxuICAgKi9cbiAgZ2V0RGV2c0hpc3RvcnlJbmZvKG1hYzogc3RyaW5nLCBwaWQ6IHN0cmluZywgbmFtZTogc3RyaW5nLCBkYXRhdGltZTogc3RyaW5nID0gJycpIHtcbiAgICByZXR1cm4gdGhpcy5SZXF1ZXN0VWFydDxhbnk+KHsgdXJsOiAnZ2V0RGV2c0hpc3RvcnlJbmZvJywgZGF0YTogeyBtYWMsIHBpZCwgbmFtZSwgZGF0YXRpbWUgfSB9KVxuICB9XG5cbiAgLyoqXG4gICAqIOiOt+WPluiuvuWkh+aTjeaOp+aMh+S7pFxuICAgKiBAcGFyYW0gcHJvdG9jb2wgXG4gICAqL1xuICBnZXREZXZPcHJhdGUocHJvdG9jb2w6IHN0cmluZykge1xuICAgIHJldHVybiB0aGlzLlJlcXVlc3RVYXJ0PFBpY2s8UHJvdG9jb2xDb25zdGFudFRocmVzaG9sZCwgJ09wcmF0ZUluc3RydWN0Jz4+KHsgdXJsOiAnZ2V0RGV2T3ByYXRlJywgZGF0YTogeyBwcm90b2NvbCB9IH0pXG4gIH1cblxuICAvKipcbiAgICog5Zu65a6a5Y+R6YCB6K6+5aSH5pON5L2c5oyH5LukXG4gICAqIEBwYXJhbSBxdWVyeSBcbiAgICogQHBhcmFtIGl0ZW0gXG4gICAqL1xuICBTZW5kUHJvY290b2xJbnN0cnVjdFNldChxdWVyeTogUGFydGlhbDxpbnN0cnVjdFF1ZXJ5QXJnPiwgaXRlbTogT3ByYXRlSW5zdHJ1Y3QpIHtcbiAgICByZXR1cm4gdGhpcy5SZXF1ZXN0VWFydDxhbnk+KHsgdXJsOiAnU2VuZFByb2NvdG9sSW5zdHJ1Y3RTZXQnLCBkYXRhOiB7IHF1ZXJ5LCBpdGVtIH0sIG1ldGhvZDogJ1BPU1QnIH0pXG4gIH1cblxuICAvKipcbiAgICog6I635Y+W55So5oi36Ieq5a6a5LmJ5Y2P6K6u6YWN572uXG4gICAqIEBwYXJhbSBwcm90b2NvbCBcbiAgICovXG4gIGdldFVzZXJEZXZDb25zdGFudChwcm90b2NvbDogc3RyaW5nKSB7XG4gICAgcmV0dXJuIHRoaXMuUmVxdWVzdFVhcnQ8eyB1c2VyOiBQcm90b2NvbENvbnN0YW50VGhyZXNob2xkLCBzeXM6IFByb3RvY29sQ29uc3RhbnRUaHJlc2hvbGQsIHByb3RvY29sOiBwcm90b2NvbCB9Pih7IHVybDogJ2dldFVzZXJEZXZDb25zdGFudCcsIGRhdGE6IHsgcHJvdG9jb2wgfSB9KVxuICB9XG5cbiAgLyoqXG4gICAqIOe7n+S4gOaPkOS6pOmFjee9rlxuICAgKiBAcGFyYW0gYXJnIFxuICAgKiBAcGFyYW0gdHlwZSBcbiAgICogQHBhcmFtIFByb3RvY29sIFxuICAgKi9cbiAgcHVzaFRocmVzaG9sZChhcmc6IENvbnN0YW50QWxhcm1TdGF0W10gfCBUaHJlc2hvbGRbXSB8IHN0cmluZ1tdLCB0eXBlOiBDb25zdGFudFRocmVzaG9sZFR5cGUsIFByb3RvY29sOiBzdHJpbmcpIHtcbiAgICByZXR1cm4gdGhpcy5SZXF1ZXN0VWFydDxhbnk+KHsgdXJsOiBcInB1c2hUaHJlc2hvbGRcIiwgZGF0YTogeyB0eXBlLCBhcmcsIFByb3RvY29sIH0sIG1ldGhvZDogXCJQT1NUXCIgfSlcbiAgfVxuXG4gIC8qKlxuICAgKiDojrflj5bnlKjmiLfnmoTlkYrorabogZTns7vmlrnlvI9cbiAgICovXG4gIGdldFVzZXJBbGFybVRlbHMoKSB7XG4gICAgcmV0dXJuIHRoaXMuUmVxdWVzdFVhcnQ8UGljazx1c2VyU2V0dXAsICdtYWlscycgfCAndGVscyc+Pih7IHVybDogJ2dldFVzZXJBbGFybVRlbHMnLCBkYXRhOiB7fSB9KVxuICB9XG5cbiAgLyoqXG4gICAqIOiuvue9rueUqOaIt+eahOWRiuitpuiBlOezu+aWueW8j1xuICAgKiBAcGFyYW0gdGVscyBcbiAgICogQHBhcmFtIG1haWxzIFxuICAgKi9cbiAgc2V0VXNlclNldHVwQ29udGFjdCh0ZWxzOiBzdHJpbmdbXSwgbWFpbHM6IHN0cmluZ1tdKSB7XG4gICAgcmV0dXJuIHRoaXMuUmVxdWVzdFVhcnQ8YW55Pih7IHVybDogJ3NldFVzZXJTZXR1cENvbnRhY3QnLCBkYXRhOiB7IHRlbHMsIG1haWxzIH0sIG1ldGhvZDogXCJQT1NUXCIgfSlcbiAgfVxuXG4gIC8qKlxuICAgKiDmt7vliqBEVFXmjILovb3orr7lpIdcbiAgICogQHBhcmFtIERldk1hYyBcbiAgICogQHBhcmFtIFR5cGUgXG4gICAqIEBwYXJhbSBtb3VudERldiBcbiAgICogQHBhcmFtIHByb3RvY29sIFxuICAgKiBAcGFyYW0gcGlkIFxuICAgKi9cbiAgYWRkVGVybWluYWxNb3VudERlKERldk1hYzogc3RyaW5nLCBUeXBlOiBzdHJpbmcsIG1vdW50RGV2OiBzdHJpbmcsIHByb3RvY29sOiBzdHJpbmcsIHBpZDogc3RyaW5nKSB7XG4gICAgcmV0dXJuIHRoaXMuUmVxdWVzdFVhcnQ8YW55Pih7IHVybDogJ2FkZFRlcm1pbmFsTW91bnREZXYnLCBkYXRhOiB7IERldk1hYywgVHlwZSwgbW91bnREZXYsIHByb3RvY29sLCBwaWQgfSwgbWV0aG9kOiBcIlBPU1RcIiB9KVxuICB9XG5cbiAgLyoqXG4gICAqIOWIoOmZpOe7iOerr+aMgui9veiuvuWkh1xuICAgKiBAcGFyYW0gRGV2TWFjIOiuvuWkh21hY1xuICAgKiBAcGFyYW0gbW91bnREZXYg5oyC6L296K6+5aSHXG4gICAqIEBwYXJhbSBwaWQgXG4gICAqL1xuICBkZWxUZXJtaW5hbE1vdW50RGV2KERldk1hYzogc3RyaW5nLCBtb3VudERldjogc3RyaW5nLCBwaWQ6IHN0cmluZykge1xuICAgIHJldHVybiB0aGlzLlJlcXVlc3RVYXJ0PGFueT4oeyB1cmw6ICdkZWxUZXJtaW5hbE1vdW50RGV2JywgZGF0YTogeyBEZXZNYWMsIG1vdW50RGV2LCBwaWQgfSwgbWV0aG9kOiBcIlBPU1RcIiB9KVxuICB9XG5cbiAgLyoqXG4gICAqIOWIoOmZpOeUqOaIt+e7iOerr+e7keWumlxuICAgKiBAcGFyYW0gbWFjIFxuICAgKi9cbiAgZGVsVXNlclRlcm1pbmFsKG1hYzogc3RyaW5nKSB7XG4gICAgcmV0dXJuIHRoaXMuUmVxdWVzdFVhcnQ8YW55Pih7IHVybDogJ2RlbFVzZXJUZXJtaW5hbCcsIGRhdGE6IHsgbWFjIH0gfSlcbiAgfVxuXG4gIC8qKlxuICAgKiDojrflj5borr7lpIfnsbvlnotcbiAgICogQHBhcmFtIFR5cGUg6K6+5aSH57G75Z6L5aSn57G7XG4gICAqL1xuICBEZXZUeXBlcyhUeXBlOiBzdHJpbmcpIHtcbiAgICByZXR1cm4gdGhpcy5SZXF1ZXN0VWFydDxEZXZzVHlwZVtdPih7IHVybDogJ0RldlR5cGVzJywgZGF0YTogeyBUeXBlIH0gfSlcbiAgfVxuXG4gIC8qKlxuICAgKiDkv67mlLnnlKjmiLfkv6Hmga9cbiAgICogQHBhcmFtIHR5cGUg5L+u5pS557G75Z6LXG4gICAqIEBwYXJhbSB2YWx1ZSDlgLxcbiAgICovXG4gIG1vZGlmeVVzZXJJbmZvKHR5cGU6ICd0ZWwnIHwgJ21haWwnIHwgJ25hbWUnLCB2YWx1ZTogc3RyaW5nKSB7XG4gICAgcmV0dXJuIHRoaXMuUmVxdWVzdFVhcnQ8YW55Pih7IHVybDogJ21vZGlmeVVzZXJJbmZvJywgZGF0YTogeyB0eXBlLCB2YWx1ZSB9IH0pXG4gIH1cblxuICAvKipcbiAgICog6I635Y+WZ3Bz5a6a5L2N55qE6K+m57uG5Zyw5Z2AXG4gICAqIEBwYXJhbSBsb2NhdGlvbiBcbiAgICovXG4gIGdldEdQU2FkZHJlc3MobG9jYXRpb246IHN0cmluZykge1xuICAgIHJldHVybiB0aGlzLlJlcXVlc3RVYXJ0PHRlbmNldE1hcD4oeyB1cmw6ICdnZXRHUFNhZGRyZXNzJywgZGF0YTogeyBsb2NhdGlvbiB9IH0pXG4gIH1cblxuICAvKipcbiAgICog5rOo6ZSA5b6u5L+hXG4gICAqL1xuICBhc3luYyBjYW5jZWx3eCgpIHtcbiAgICBjb25zdCBlbCA9IGF3YWl0IHRoaXMuUmVxdWVzdFVhcnQ8c3RyaW5nPih7IHVybDogJ2NhbmNlbHd4JywgZGF0YToge30gfSlcbiAgICB0aGlzLnRva2VuID0gXCJcIlxuICAgIHJldHVybiBlbFxuICB9XG5cbiAgLyoqXG4gICAqIOiOt+WPlueUqOaIt+aJi+acuuWPt+eggVxuICAgKi9cbiAgZ2V0VXNlclRlbCgpIHtcbiAgICByZXR1cm4gdGhpcy5SZXF1ZXN0VWFydDxzdHJpbmc+KHsgdXJsOiAnZ2V0VXNlclRlbCcsIGRhdGE6IHt9IH0pXG4gIH1cblxuICAvKipcbiAgICog5Y+R6YCB55+t5L+h6aqM6K+B56CBXG4gICAqL1xuICBzZW5kVmFsaWRhdGlvbigpIHtcbiAgICByZXR1cm4gdGhpcy5SZXF1ZXN0VWFydDxzdHJpbmc+KHsgdXJsOiAnc2VuZFZhbGlkYXRpb24nLCBkYXRhOiB7fSB9KVxuICB9XG5cbiAgLyoqXG4gICAqIOajgOmqjOefreS/oemqjOivgeeggVxuICAgKiBAcGFyYW0gY29kZSDpqozor4HnoIFcbiAgICovXG4gIFZhbGlkYXRpb25Db2RlKGNvZGU6IG51bWJlcikge1xuICAgIHJldHVybiB0aGlzLlJlcXVlc3RVYXJ0PHN0cmluZz4oeyB1cmw6ICdWYWxpZGF0aW9uQ29kZScsIGRhdGE6IHsgY29kZSB9IH0pXG4gIH1cblxuICAvKipcbiAgICog6I635Y+W6IqC54K55YiX6KGoXG4gICAqL1xuICBnZXROb2RlcygpIHtcbiAgICByZXR1cm4gdGhpcy5SZXF1ZXN0VWFydDxOb2RlQ2xpZW50W10+KHsgdXJsOiAnZ2V0Tm9kZXMnLCBkYXRhOiB7fSB9KVxuICB9XG5cbiAgLyoqXG4gICAqIOaJuemHj+azqOWGjERUVVxuICAgKiBAcGFyYW0gbm9kZSDoioLngrnlkI3np7BcbiAgICogQHBhcmFtIGR0dXMgZHR1TWFj5pWw57uEXG4gICAqL1xuICBiYWN0aFJlZ2lzdGVyRFRVKG5vZGU6IHN0cmluZywgZHR1czogc3RyaW5nW10pIHtcbiAgICByZXR1cm4gdGhpcy5SZXF1ZXN0VWFydDxzdHJpbmc+KHsgdXJsOiAnYmFjdGhSZWdpc3RlckRUVScsIGRhdGE6IHsgbm9kZSwgZHR1cyB9LCBtZXRob2Q6IFwiUE9TVFwiIH0pXG4gIH1cblxuICAvKipcbiAgICog5re75Yqg6Jma5ouf6K6+5aSHXG4gICAqL1xuICBhZGRWbSgpIHtcbiAgICByZXR1cm4gdGhpcy5SZXF1ZXN0VWFydDxUZXJtaW5hbFtdPih7IHVybDogJ2FkZFZtJywgZGF0YToge30gfSlcbiAgfVxuXG4gIC8qKlxuICAgKiDkv67mlLlEVFXlkI3np7BcbiAgICogQHBhcmFtIGR0dSBtYWNcbiAgICogQHBhcmFtIG5hbWUg5paw55qE5ZCN56ewXG4gICAqL1xuICBtb2RpZnlEVFVOYW1lKGR0dTogc3RyaW5nLCBuYW1lOiBzdHJpbmcpIHtcbiAgICByZXR1cm4gdGhpcy5SZXF1ZXN0VWFydDxzdHJpbmc+KHsgdXJsOiAnbW9kaWZ5RFRVTmFtZScsIGRhdGE6IHsgZHR1LCBuYW1lIH0gfSlcbiAgfVxuXG4gIC8qKlxuICAgKiDmm7TmlrBkdHXlrprkvY1cbiAgICogQHBhcmFtIGR0dSBkdHVNYWNcbiAgICogQHBhcmFtIGp3IOe7j+e6rOW6plxuICAgKi9cbiAgdXBkYXRlR3BzKGR0dTogc3RyaW5nLCBqdzogc3RyaW5nKSB7XG4gICAgcmV0dXJuIHRoaXMuUmVxdWVzdFVhcnQ8c3RyaW5nPih7IHVybDogJ3VwZGF0ZUdwcycsIGRhdGE6IHsgZHR1LCBqdyB9IH0pXG4gIH1cblxuICAvKipcbiAgICogd2Vi55m75b2VXG4gICAqIEBwYXJhbSBjb2RlIHRva2VuXG4gICAqL1xuICB3ZWJMb2dpbihjb2RlOiBzdHJpbmcpIHtcbiAgICByZXR1cm4gdGhpcy5SZXF1ZXN0VWFydDxzdHJpbmc+KHsgdXJsOiAnd2ViTG9naW4nLCBkYXRhOiB7IGNvZGUsIHRva2VuOiB0aGlzLnRva2VuIH0gfSlcbiAgfVxuXG4gIC8qKlxuICAgKiDojrflj5ZkdHXov5znqIvosIPor5XnvZHlnYBcbiAgICogQHBhcmFtIG1hYyBcbiAgICovXG4gIGlvdFJlbW90ZVVybChtYWM6IHN0cmluZykge1xuICAgIHJldHVybiB0aGlzLlJlcXVlc3RVYXJ0PHN0cmluZz4oeyB1cmw6ICdpb3RSZW1vdGVVcmwnLCBkYXRhOiB7IG1hYyB9IH0pXG4gIH1cblxuICAvKipcbiAgICogQG1ldGhvZCBhcGnpgJrnlKhyZXF1c3Tmlrnms5VcbiAgICogQHBhcmFtIG9iamVjdCBcbiAgICovXG4gIHByaXZhdGUgYXN5bmMgUmVxdWVzdFVhcnQ8VD4ob2JqZWN0OiB7IHVybDogdXJsLCBkYXRhOiBPYmplY3QsIG1ldGhvZD86IFwiR0VUXCIgfCBcIlBPU1RcIiB9KSB7XG4gICAgLy93eC5zaG93TG9hZGluZyh7IHRpdGxlOiAn5q2j5Zyo5p+l6K+iJyB9KVxuICAgIC8vIHd4LnNob3dOYXZpZ2F0aW9uQmFyTG9hZGluZygpXG4gICAgY29uc3QgdG9rZW46IHN0cmluZyA9IHRoaXMudG9rZW4gfHwgYXdhaXQgd3guZ2V0U3RvcmFnZSh7IGtleTogJ3Rva2VuJyB9KS50aGVuKGVsID0+IGVsLmRhdGEpLmNhdGNoKCgpID0+IFwiXCIpXG4gICAgcmV0dXJuIGF3YWl0IG5ldyBQcm9taXNlPEFwb2xsb01vbmdvUmVzdWx0PFQ+PigocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICB3eC5yZXF1ZXN0KHtcbiAgICAgICAgdGltZW91dDogMTAwMCAqIDYwLFxuICAgICAgICB1cmw6IHRoaXMudXJsICsgb2JqZWN0LnVybCxcbiAgICAgICAgZGF0YTogb2JqZWN0LmRhdGEsLy9PYmplY3QuYXNzaWduKHsgdG9rZW46IHRva2VuIH0sIG9iamVjdC5kYXRhKSxcbiAgICAgICAgbWV0aG9kOiBvYmplY3QubWV0aG9kIHx8IFwiR0VUXCIsXG4gICAgICAgIGhlYWRlcjogeyB0b2tlbjogdG9rZW4gfSxcbiAgICAgICAgc3VjY2VzczogcmVzID0+IHtcbiAgICAgICAgICAvLyBjb25zb2xlLmxvZyhyZXMpO1xuICAgICAgICAgIC8vIHd4LmhpZGVMb2FkaW5nKClcbiAgICAgICAgICBpZiAocmVzLnN0YXR1c0NvZGUgIT09IDIwMCkge1xuICAgICAgICAgICAgd3guc2hvd1RvYXN0KHtcbiAgICAgICAgICAgICAgdGl0bGU6IFN0cmluZyhyZXMuc3RhdHVzQ29kZSksXG4gICAgICAgICAgICAgIGNvbnRlbnQ6IHJlcy5kYXRhLnRvU3RyaW5nKCkgfHwgcmVzLmVyck1zZyxcbiAgICAgICAgICAgICAgc3VjY2VzcygpIHtcbiAgICAgICAgICAgICAgICB3eC5yZUxhdW5jaCh7IHVybDogJy9wYWdlcy9pbmRleC9pbmRleCcgfSlcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIHJlamVjdChyZXMpXG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgICAgICByZXNvbHZlKHJlcy5kYXRhIGFzIGFueSlcbiAgICAgICAgICAgIH0sIDApXG4gICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBmYWlsOiBlID0+IHtcbiAgICAgICAgICB3eC5zaG93TW9kYWwoeyB0aXRsZTogJ+acjeWKoeWZqOmUmeivrycsIGNvbnRlbnQ6IGUuZXJyTXNnIH0pXG4gICAgICAgICAgLy8gd3guaGlkZUxvYWRpbmcoKVxuICAgICAgICAgIHJlamVjdChlKVxuICAgICAgICB9LFxuICAgICAgICBjb21wbGV0ZTogKCkgPT4ge1xuICAgICAgICAgIC8vIHd4LmhpZGVOYXZpZ2F0aW9uQmFyTG9hZGluZygpXG4gICAgICAgICAgLy8gd3guaGlkZUxvYWRpbmcoKVxuICAgICAgICB9XG4gICAgICB9KVxuICAgIH0pXG4gIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgbmV3IGFwaSgpXG4iXX0=