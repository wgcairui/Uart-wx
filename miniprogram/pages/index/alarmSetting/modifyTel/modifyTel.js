"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const util_1 = require("../../../../utils/util");
Page({
    data: {
        tel: [],
        mail: []
    },
    onLoad: function () {
        const eventChannel = this.getOpenerEventChannel();
        eventChannel.on("alarm", ({ tel, mail }) => {
            this.setData({
                tel,
                mail
            });
        });
    },
    addTel() {
        const tel = [...this.data.tel, ''];
        this.setData({
            tel
        });
    },
    addMail() {
        const mail = [...this.data.mail, ''];
        this.setData({
            mail
        });
    },
    modifyTel(e) {
        const old = e.currentTarget.dataset.key;
        const newVal = e.detail.value;
        if ((0, util_1.RgexpTel)(newVal) || newVal.length === 0) {
            const i = this.data.tel.findIndex(el => el === old);
            this.data.tel.splice(i, 1, newVal);
            this.setData({
                tel: this.data.tel.filter(el => el)
            });
        }
        else {
            wx.showModal({
                content: `${newVal}不是正确的手机号格式`,
                title: "号码错误"
            });
        }
    },
    modifyMail(e) {
        const old = e.currentTarget.dataset.key;
        const newVal = e.detail.value;
        if ((0, util_1.RgexpMail)(newVal) || newVal.length === 0) {
            const i = this.data.mail.findIndex(el => el === old);
            this.data.mail.splice(i, 1, newVal);
            this.setData({
                mail: this.data.mail.filter(el => el)
            });
        }
        else {
            wx.showModal({
                content: `${newVal}不是正确的邮箱格式`,
                title: "邮箱错误"
            });
        }
    },
    submit() {
        if (!this.disbledSumbit()) {
            wx.showToast({
                title: "联系方式不能空",
                icon: "error"
            });
            return;
        }
        const eventChannel = this.getOpenerEventChannel();
        const { tel, mail } = this.data;
        eventChannel.emit("modifyOk", { tel, mail });
        wx.navigateBack();
    },
    disbledSumbit() {
        return this.data.mail.every(el => (0, util_1.RgexpMail)(el)) && this.data.tel.every(el => (0, util_1.RgexpTel)(el));
    },
    onReady: function () {
    },
    onShow: function () {
    },
    onHide: function () {
    },
    onUnload: function () {
    },
    onPullDownRefresh: function () {
    },
    onReachBottom: function () {
    },
    onShareAppMessage: function () {
    }
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibW9kaWZ5VGVsLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsibW9kaWZ5VGVsLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7O0FBQ0EsaURBQTREO0FBQzVELElBQUksQ0FBQztJQUtILElBQUksRUFBRTtRQUNKLEdBQUcsRUFBRSxFQUFjO1FBQ25CLElBQUksRUFBRSxFQUFjO0tBQ3JCO0lBS0QsTUFBTSxFQUFFO1FBQ04sTUFBTSxZQUFZLEdBQUcsSUFBSSxDQUFDLHFCQUFxQixFQUFFLENBQUE7UUFDakQsWUFBWSxDQUFDLEVBQUUsQ0FBQyxPQUFPLEVBQUUsQ0FBQyxFQUFFLEdBQUcsRUFBRSxJQUFJLEVBQXFDLEVBQUUsRUFBRTtZQUM1RSxJQUFJLENBQUMsT0FBTyxDQUFDO2dCQUNYLEdBQUc7Z0JBQ0gsSUFBSTthQUNMLENBQUMsQ0FBQTtRQUNKLENBQUMsQ0FBQyxDQUFBO0lBQ0osQ0FBQztJQUVELE1BQU07UUFDSixNQUFNLEdBQUcsR0FBRyxDQUFDLEdBQUcsSUFBSSxDQUFDLElBQUksQ0FBQyxHQUFHLEVBQUUsRUFBRSxDQUFDLENBQUE7UUFDbEMsSUFBSSxDQUFDLE9BQU8sQ0FBQztZQUNYLEdBQUc7U0FDSixDQUFDLENBQUE7SUFDSixDQUFDO0lBRUQsT0FBTztRQUNMLE1BQU0sSUFBSSxHQUFHLENBQUMsR0FBRyxJQUFJLENBQUMsSUFBSSxDQUFDLElBQUksRUFBRSxFQUFFLENBQUMsQ0FBQTtRQUNwQyxJQUFJLENBQUMsT0FBTyxDQUFDO1lBQ1gsSUFBSTtTQUNMLENBQUMsQ0FBQTtJQUNKLENBQUM7SUFFRCxTQUFTLENBQUMsQ0FBWTtRQUNwQixNQUFNLEdBQUcsR0FBRyxDQUFDLENBQUMsYUFBYSxDQUFDLE9BQU8sQ0FBQyxHQUFHLENBQUE7UUFDdkMsTUFBTSxNQUFNLEdBQUcsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxLQUFlLENBQUE7UUFDdkMsSUFBSSxJQUFBLGVBQVEsRUFBQyxNQUFNLENBQUMsSUFBSSxNQUFNLENBQUMs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RW5CLENBQUM7SUFLRCxhQUFhLEVBQUU7SUFFZixDQUFDO0lBS0QsaUJBQWlCLEVBQUU7SUFFbkIsQ0FBQztDQUNGLENBQUMsQ0FBQSIsInNvdXJjZXNDb250ZW50IjpbIi8vIHBhZ2VzL2luZGV4L2FsYXJtU2V0dGluZy9tb2RpZnlUZWwvbW9kaWZ5VGVsLmpzXG5pbXBvcnQgeyBSZ2V4cE1haWwsIFJnZXhwVGVsIH0gZnJvbSBcIi4uLy4uLy4uLy4uL3V0aWxzL3V0aWxcIlxuUGFnZSh7XG5cbiAgLyoqXG4gICAqIOmhtemdoueahOWIneWni+aVsOaNrlxuICAgKi9cbiAgZGF0YToge1xuICAgIHRlbDogW10gYXMgc3RyaW5nW10sXG4gICAgbWFpbDogW10gYXMgc3RyaW5nW11cbiAgfSxcblxuICAvKipcbiAgICog55Sf5ZG95ZGo5pyf5Ye95pWwLS3nm5HlkKzpobXpnaLliqDovb1cbiAgICovXG4gIG9uTG9hZDogZnVuY3Rpb24gKCkge1xuICAgIGNvbnN0IGV2ZW50Q2hhbm5lbCA9IHRoaXMuZ2V0T3BlbmVyRXZlbnRDaGFubmVsKClcbiAgICBldmVudENoYW5uZWwub24oXCJhbGFybVwiLCAoeyB0ZWwsIG1haWwgfTogeyB0ZWw6IHN0cmluZ1tdLCBtYWlsOiBzdHJpbmdbXSB9KSA9PiB7XG4gICAgICB0aGlzLnNldERhdGEoe1xuICAgICAgICB0ZWwsXG4gICAgICAgIG1haWxcbiAgICAgIH0pXG4gICAgfSlcbiAgfSxcblxuICBhZGRUZWwoKSB7XG4gICAgY29uc3QgdGVsID0gWy4uLnRoaXMuZGF0YS50ZWwsICcnXVxuICAgIHRoaXMuc2V0RGF0YSh7XG4gICAgICB0ZWxcbiAgICB9KVxuICB9LFxuXG4gIGFkZE1haWwoKSB7XG4gICAgY29uc3QgbWFpbCA9IFsuLi50aGlzLmRhdGEubWFpbCwgJyddXG4gICAgdGhpcy5zZXREYXRhKHtcbiAgICAgIG1haWxcbiAgICB9KVxuICB9LFxuXG4gIG1vZGlmeVRlbChlOiB2YW50RXZlbnQpIHtcbiAgICBjb25zdCBvbGQgPSBlLmN1cnJlbnRUYXJnZXQuZGF0YXNldC5rZXlcbiAgICBjb25zdCBuZXdWYWwgPSBlLmRldGFpbC52YWx1ZSBhcyBzdHJpbmdcbiAgICBpZiAoUmdleHBUZWwobmV3VmFsKSB8fCBuZXdWYWwubGVuZ3RoID09PSAwKSB7XG4gICAgICBjb25zdCBpID0gdGhpcy5kYXRhLnRlbC5maW5kSW5kZXgoZWwgPT4gZWwgPT09IG9sZClcbiAgICAgIHRoaXMuZGF0YS50ZWwuc3BsaWNlKGksIDEsIG5ld1ZhbClcbiAgICAgIHRoaXMuc2V0RGF0YSh7XG4gICAgICAgIHRlbDogdGhpcy5kYXRhLnRlbC5maWx0ZXIoZWwgPT4gZWwpXG4gICAgICB9KVxuICAgIH0gZWxzZSB7XG4gICAgICB3eC5zaG93TW9kYWwoe1xuICAgICAgICBjb250ZW50OiBgJHtuZXdWYWx95LiN5piv5q2j56Gu55qE5omL5py65Y+35qC85byPYCxcbiAgICAgICAgdGl0bGU6IFwi5Y+356CB6ZSZ6K+vXCJcbiAgICAgIH0pXG4gICAgfVxuICB9LFxuXG4gIG1vZGlmeU1haWwoZTogdmFudEV2ZW50KSB7XG4gICAgY29uc3Qgb2xkID0gZS5jdXJyZW50VGFyZ2V0LmRhdGFzZXQua2V5XG4gICAgY29uc3QgbmV3VmFsID0gZS5kZXRhaWwudmFsdWUgYXMgc3RyaW5nXG4gICAgaWYgKFJnZXhwTWFpbChuZXdWYWwpIHx8IG5ld1ZhbC5sZW5ndGggPT09IDApIHtcbiAgICAgIGNvbnN0IGkgPSB0aGlzLmRhdGEubWFpbC5maW5kSW5kZXgoZWwgPT4gZWwgPT09IG9sZClcbiAgICAgIHRoaXMuZGF0YS5tYWlsLnNwbGljZShpLCAxLCBuZXdWYWwpXG4gICAgICB0aGlzLnNldERhdGEoe1xuICAgICAgICBtYWlsOiB0aGlzLmRhdGEubWFpbC5maWx0ZXIoZWwgPT4gZWwpXG4gICAgICB9KVxuICAgIH0gZWxzZSB7XG4gICAgICB3eC5zaG93TW9kYWwoe1xuICAgICAgICBjb250ZW50OiBgJHtuZXdWYWx95LiN5piv5q2j56Gu55qE6YKu566x5qC85byPYCxcbiAgICAgICAgdGl0bGU6IFwi6YKu566x6ZSZ6K+vXCJcbiAgICAgIH0pXG4gICAgfVxuICB9LFxuXG4gIHN1Ym1pdCgpIHtcbiAgICBpZighdGhpcy5kaXNibGVkU3VtYml0KCkpIHtcbiAgICAgIHd4LnNob3dUb2FzdCh7XG4gICAgICAgIHRpdGxlOlwi6IGU57O75pa55byP5LiN6IO956m6XCIsXG4gICAgICAgIGljb246XCJlcnJvclwiXG4gICAgICB9KVxuICAgICAgcmV0dXJuXG4gICAgfVxuICAgIGNvbnN0IGV2ZW50Q2hhbm5lbCA9IHRoaXMuZ2V0T3BlbmVyRXZlbnRDaGFubmVsKClcbiAgICBjb25zdCB7IHRlbCwgbWFpbCB9ID0gdGhpcy5kYXRhXG4gICAgZXZlbnRDaGFubmVsLmVtaXQoXCJtb2RpZnlPa1wiLCB7IHRlbCwgbWFpbCB9KVxuICAgIHd4Lm5hdmlnYXRlQmFjaygpXG4gIH0sXG5cbiAgZGlzYmxlZFN1bWJpdCgpIHtcbiAgICByZXR1cm4gdGhpcy5kYXRhLm1haWwuZXZlcnkoZWwgPT4gUmdleHBNYWlsKGVsKSkgJiYgdGhpcy5kYXRhLnRlbC5ldmVyeShlbCA9PiBSZ2V4cFRlbChlbCkpXG4gIH0sXG5cbiAgLyoqXG4gICAqIOeUn+WRveWRqOacn+WHveaVsC0t55uR5ZCs6aG16Z2i5Yid5qyh5riy5p+T5a6M5oiQXG4gICAqL1xuICBvblJlYWR5OiBmdW5jdGlvbiAoKSB7XG5cbiAgfSxcblxuICAvKipcbiAgICog55Sf5ZG95ZGo5pyf5Ye95pWwLS3nm5HlkKzpobXpnaLmmL7npLpcbiAgICovXG4gIG9uU2hvdzogZnVuY3Rpb24gKCkge1xuXG4gIH0sXG5cbiAgLyoqXG4gICAqIOeUn+WRveWRqOacn+WHveaVsC0t55uR5ZCs6aG16Z2i6ZqQ6JePXG4gICAqL1xuICBvbkhpZGU6IGZ1bmN0aW9uICgpIHtcblxuICB9LFxuXG4gIC8qKlxuICAgKiDnlJ/lkb3lkajmnJ/lh73mlbAtLeebkeWQrOmhtemdouWNuOi9vVxuICAgKi9cbiAgb25VbmxvYWQ6IGZ1bmN0aW9uICgpIHtcblxuICB9LFxuXG4gIC8qKlxuICAgKiDpobXpnaLnm7jlhbPkuovku7blpITnkIblh73mlbAtLeebkeWQrOeUqOaIt+S4i+aLieWKqOS9nFxuICAgKi9cbiAgb25QdWxsRG93blJlZnJlc2g6IGZ1bmN0aW9uICgpIHtcblxuICB9LFxuXG4gIC8qKlxuICAgKiDpobXpnaLkuIrmi4nop6blupXkuovku7bnmoTlpITnkIblh73mlbBcbiAgICovXG4gIG9uUmVhY2hCb3R0b206IGZ1bmN0aW9uICgpIHtcblxuICB9LFxuXG4gIC8qKlxuICAgKiDnlKjmiLfngrnlh7vlj7PkuIrop5LliIbkuqtcbiAgICovXG4gIG9uU2hhcmVBcHBNZXNzYWdlOiBmdW5jdGlvbiAoKSB7XG5cbiAgfVxufSkiXX0=