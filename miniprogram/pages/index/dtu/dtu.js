"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const util_1 = require("../../../utils/util");
const api_1 = require("../../../utils/api");
Page({
    data: {
        mac: '',
        terminal: {},
        dtuItem: [],
        jwSupport: false,
        longitude: '',
        latitude: '',
        markers: [],
        address: '',
        recommend: '',
        devPics: {
            "UPS": 'https://besiv-uart.oss-cn-hangzhou.aliyuncs.com/png/99daa3e07c7b60ef7e16ed8b9fe7cf33.png',
            "温湿度": 'https://besiv-uart.oss-cn-hangzhou.aliyuncs.com/png/5fc7d6fe0571b714d5a3395a8c7a9f12.png',
            "电量仪": 'https://besiv-uart.oss-cn-hangzhou.aliyuncs.com/png/ab52d9fccdddc0fa5b0386ea0b5cbc7f.png',
            "空调": 'https://besiv-uart.oss-cn-hangzhou.aliyuncs.com/png/c3c1852270ca35fd56135d8fda2a9977.png'
        },
    },
    onLoad: function (options) {
        this.setData({
            mac: options.mac
        });
        this.start();
    },
    async start() {
        const { data: terminal } = await api_1.default.getTerminal(this.data.mac);
        const jw = terminal.jw && terminal.jw.length > 10 ? terminal.jw.split(',') : false;
        terminal.uptime = (0, util_1.parseTime)(terminal.uptime);
        const devs = terminal.mountDevs.map((dev) => {
            dev.pic = this.data.devPics[dev.Type];
            return dev;
        });
        this.setData({
            terminal,
            dtuItem: devs,
            jwSupport: Boolean(jw),
        });
        if (jw) {
            const mark = {
                iconPath: "../../../assert/mark.png",
                latitude: Number(jw[1]),
                longitude: Number(jw[0]),
                title: terminal.name,
                width: 50,
                height: 50
            };
            this.setData({
                longitude: jw[0],
                latitude: jw[1],
                markers: [mark]
            });
            api_1.default.getGPSaddress([jw[1], jw[0]].join(',')).then(({ code, data, msg }) => {
                if (code) {
                    this.setData({
                        address: data.address,
                        recommend: data.formatted_addresses.recommend
                    });
                }
                else {
                    wx.showToast({ title: msg });
                }
            });
        }
        wx.setNavigationBarTitle({ title: terminal.name || terminal.DevMac });
    },
    showMountDevData(event) {
        const { pid, mountDev, protocol, Type } = event.currentTarget.dataset.item;
        const { DevMac } = this.data.terminal;
        wx.navigateTo({
            url: '/pages/index/devs/devs' + (0, util_1.ObjectToStrquery)({ pid: String(pid), mountDev, protocol, DevMac, Type })
        });
    },
    markertap(_e) {
    },
    async nameChange(event) {
        const value = event.detail.value;
        const { code, msg } = await api_1.default.modifyTerminal(this.data.terminal.DevMac, value);
        if (!code) {
            wx.showModal({
                title: "Error",
                content: msg
            });
        }
        else {
            this.setData({
                "terminal.name": value
            });
            wx.setStorage({
                key: this.data.terminal._id,
                data: this.data.terminal
            });
        }
    },
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZHR1LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiZHR1LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7O0FBQUEsOENBQWlFO0FBQ2pFLDRDQUFvQztBQUdwQyxJQUFJLENBQUM7SUFLSCxJQUFJLEVBQUU7UUFDSixHQUFHLEVBQUUsRUFBRTtRQUNQLFFBQVEsRUFBRSxFQUFtQjtRQUM3QixPQUFPLEVBQUUsRUFBOEI7UUFDdkMsU0FBUyxFQUFFLEtBQUs7UUFDaEIsU0FBUyxFQUFFLEVBQUU7UUFDYixRQUFRLEVBQUUsRUFBRTtRQUNaLE9BQU8sRUFBRSxFQUFXO1FBQ3BCLE9BQU8sRUFBRSxFQUFFO1FBQ1gsU0FBUyxFQUFFLEVBQUU7UUFDYixPQUFPLEVBQUU7WUFDUCxLQUFLLEVBQUUsMEZBQTBGO1lBQ2pHLEtBQUssRUFBRSwwRkFBMEY7WUFDakcsS0FBSyxFQUFFLDBGQUEwRjtZQUNqRyxJQUFJLEVBQUUsMEZBQTBGO1NBQ2pHO0tBQ0Y7SUFLRCxNQUFNLEVBQUUsVUFBVSxPQUF3QjtRQUN4QyxJQUFJLENBQUMsT0FBTyxDQUFDO1lBQ1gsR0FBRyxFQUFFLE9BQU8sQ0FBQyxHQUFHO1NBQ2pCLENBQUMsQ0FBQTtRQUNGLElBQUksQ0FBQyxLQUFLLEVBQUUsQ0FBQTtJQUNkLENBQUM7SUFFRCxLQUFLLENBQUMsS0FBSztRQUNULE1BQU0sRUFBRSxJQUFJLEVBQUUsUUFBUSxFQUFFLEdBQUcsTUFBTSxhQUFHLENBQUMsV0FBVyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUE7UUFDL0QsTUFBTSxFQUFFLEdBQUcsUUFBUSxDQUFDLEVBQUUsSUFBSSxRQUFRLENBQUMsRUFBRSxDQUFDLE1BQU0sR0FBRyxFQUFFLENBQUMsQ0FBQyxDQUFDLFFBQVEsQ0FBQyxFQUFFLENBQUMsS0FBSyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQyxLQUFLLENBQUE7UUFFbEYsUUFBUSxDQUFDLE1BQU0sR0FBRyxJQUFBLGdCQUFTLEVBQUMsUUFBUSxDQUFDLE1BQU0sQ0FBQyxDQUFBO1FBRTVDLE1BQU0sSUFBSSxHQUFHLFFBQVEsQ0FBQyxTQUFTLENBQUMsR0FBRyxDQUFDLENBQUMsR0FBTyxFQUFFLEVBQUU7WUFDOUMsR0FBRyxDQUFDLEdBQUcsR0FBSSxJQUFJLENBQUMsSUFBSSxDQUFDLE9BQWUsQ0FBQyxHQUFHLENBQUMsSUFBSSxDQUFDLENBQUE7WUFDOUMsT0FBTyxHQUFHLENBQUE7UUFDWixDQUFDLENBQUMsQ0FBQTtRQUNGLElBQUksQ0FBQyxPQUFPLENBQUM7WUFDWCxRQUFRO1lBQ1IsT0FBTyxFQUFFLElBQUk7WUFDYixTQUFTLEVBQUUsT0FBTyxDQUFDLEVBQUUsQ0FBQztTQUN2QixDQUFDLENBQUE7UUFDRixJQUFJLEVBQUUsRUFBRTtZQUNOLE1BQU0sSUFBSSxHQUFHO2dCQUNYLFFBQVEsRUFBRSwwQkFBMEI7Z0JBQ3BDLFFBQVEsRUFBRSxNQUFNLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDO2dCQUN2QixTQUFTLEVBQUUsTUFBTSxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQztnQkFDeEIsS0FBSyxFQUFFLFFBQVEsQ0FBQyxJQUFJO2dCQUNwQixLQUFLLEVBQUUsRUFBRTtnQkFDVCxNQUFNLEVBQUUsRUFBRTthQUNYLENBQUE7WUFDRCxJQUFJLENBQUMsT0FBTyxDQUFDO2dCQUNYLFNBQVMsRUFBRSxFQUFFLENBQUMsQ0FBQyxDQUFDO2dCQUNoQixRQUFRLEVBQUUsRUFBRSxDQUFDLENBQUMsQ0FBQztnQkFDZixPQUFPLEVBQUUsQ0FBQyxJQUFJLENBQUM7YUFDaEIsQ0FBQyxDQUFBO1lBRUYsYUFBRyxDQUFDLGFBQWEsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsRUFBRSxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUUsR0FBRyxFQUFFLEVBQUUsRUFBRTtnQkFDdkUsSUFBSSxJQUFJLEVBQUU7b0JBQ1IsSUFBSSxDQUFDLE9BQU8sQ0FBQzt3QkFDWCxPQUFPLEVBQUUsSUFBSSxDQUFDLE9BQU87d0JBQ3JCLFNBQVMsRUFBRSxJQUFJLENBQUMsbUJBQW1CLENBQUMsU0FBUztxQkFDOUMsQ0FBQyxDQUFBO2lCQUNIO3FCQUFNO29CQUNMLEVBQUUsQ0FBQyxTQUFTLENBQUMsRUFBRSxLQUFLLEVBQUUsR0FBRyxFQUFFLENBQUMsQ0FBQTtpQkFDN0I7WUFDSCxDQUFDLENBQUMsQ0FBQTtTQUNIO1FBQ0QsRUFBRSxDQUFDLHFCQUFxQixDQUFDLEVBQUUsS0FBSyxFQUFFLFFBQVEsQ0FBQyxJQUFJLElBQUksUUFBUSxDQUFDLE1BQU0sRUFBRSxDQUFDLENBQUE7SUFDdkUsQ0FBQztJQUdELGdCQUFnQixDQUFDLEtBQXdDO1FBQ3ZELE1BQU0sRUFBRSxHQUFHLEVBQUUsUUFBUSxFQUFFLFFBQVEsRUFBRSxJQUFJLEVBQUUsR0FBRyxLQUFLLENBQUMsYUFBYSxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUE7UUFDMUUsTUFBTSxFQUFFLE1BQU0sRUFBRSxHQUFHLElBQUksQ0FBQyxJQUFJLENBQUMsUUFBUSxDQUFBO1FBQ3JDLEVBQUUsQ0FBQyxVQUFVLENBQUM7WUFDWixHQUFHLEVBQUUsd0JBQXdCLEdBQUcsSUFBQSx1QkFBZ0IsRUFBQyxFQUFFLEdBQUcsRUFBRSxNQUFNLENBQUMsR0FBRyxDQUFDLEVBQUUsUUFBUSxFQUFFLFFBQVEsRUFBRSxNQUFNLEVBQUUsSUFBSSxFQUFFLENBQUM7U0FDekcsQ0FBQyxDQUFBO0lBQ0osQ0FBQztJQUVELFNBQVMsQ0FBQyxFQUFhO0lBVXZCLENBQUM7SUFFRCxLQUFLLENBQUMsVUFBVSxDQUFDLEtBQWdCO1FBQy9CLE1BQU0sS0FBSyxHQUFHLEtBQUssQ0FBQyxNQUFNLENBQUMsS0FBSyxDQUFBO1FBQ2hDLE1BQU0sRUFBRSxJQUFJLEVBQUUsR0FBRyxFQUFFLEdBQUcsTUFBTSxhQUFHLENBQUMsY0FBYyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsUUFBUSxDQUFDLE1BQU0sRUFBRSxLQUFLLENBQUMsQ0FBQTtRQUNoRixJQUFJLENBQUMsSUFBSSxFQUFFO1lBQ1QsRUFBRSxDQUFDLFNBQVMsQ0FBQztnQkFDWCxLQUFLLEVBQUUsT0FBTztnQkFDZCxPQUFPLEVBQUUsR0FBRzthQUNiLENBQUMsQ0FBQTtTQUNIO2FBQU07WUFDTCxJQUFJLENBQUMsT0FBTyxDQUFDO2dCQUNYLGVBQWUsRUFBRSxLQUFLO2FBQ3ZCLENBQUMsQ0FBQTtZQUNGLEVBQUUsQ0FBQyxVQUFVLENBQUM7Z0JBQ1osR0FBRyxFQUFFLElBQUksQ0FBQyxJQUFJLENBQUMsUUFBUSxDQUFDLEdBQVU7Z0JBQ2xDLElBQUksRUFBRSxJQUFJLENBQUMsSUFBSSxDQUFDLFFBQVE7YUFDekIsQ0FBQyxDQUFBO1NBQ0g7SUFDSCxDQUFDO0NBMkRGLENBQUMsQ0FBQSIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IE9iamVjdFRvU3RycXVlcnksIHBhcnNlVGltZSB9IGZyb20gXCIuLi8uLi8uLi91dGlscy91dGlsXCJcbmltcG9ydCBhcGkgZnJvbSBcIi4uLy4uLy4uL3V0aWxzL2FwaVwiXG5cbi8vIG1pbmlwcm9ncmFtL3BhZ2VzL2luZGV4L2R0dS9kdHUuanNcblBhZ2Uoe1xuXG4gIC8qKlxuICAgKiDpobXpnaLnmoTliJ3lp4vmlbDmja5cbiAgICovXG4gIGRhdGE6IHtcbiAgICBtYWM6ICcnLFxuICAgIHRlcm1pbmFsOiB7fSBhcyBVYXJ0LlRlcm1pbmFsLFxuICAgIGR0dUl0ZW06IFtdIGFzIFVhcnQuVGVybWluYWxNb3VudERldnNbXSxcbiAgICBqd1N1cHBvcnQ6IGZhbHNlLFxuICAgIGxvbmdpdHVkZTogJycsXG4gICAgbGF0aXR1ZGU6ICcnLFxuICAgIG1hcmtlcnM6IFtdIGFzIGFueVtdLFxuICAgIGFkZHJlc3M6ICcnLFxuICAgIHJlY29tbWVuZDogJycsXG4gICAgZGV2UGljczoge1xuICAgICAgXCJVUFNcIjogJ2h0dHBzOi8vYmVzaXYtdWFydC5vc3MtY24taGFuZ3pob3UuYWxpeXVuY3MuY29tL3BuZy85OWRhYTNlMDdjN2I2MGVmN2UxNmVkOGI5ZmU3Y2YzMy5wbmcnLFxuICAgICAgXCLmuKnmub/luqZcIjogJ2h0dHBzOi8vYmVzaXYtdWFydC5vc3MtY24taGFuZ3pob3UuYWxpeXVuY3MuY29tL3BuZy81ZmM3ZDZmZTA1NzFiNzE0ZDVhMzM5NWE4YzdhOWYxMi5wbmcnLFxuICAgICAgXCLnlLXph4/ku6pcIjogJ2h0dHBzOi8vYmVzaXYtdWFydC5vc3MtY24taGFuZ3pob3UuYWxpeXVuY3MuY29tL3BuZy9hYjUyZDlmY2NkZGRjMGZhNWIwMzg2ZWEwYjVjYmM3Zi5wbmcnLFxuICAgICAgXCLnqbrosINcIjogJ2h0dHBzOi8vYmVzaXYtdWFydC5vc3MtY24taGFuZ3pob3UuYWxpeXVuY3MuY29tL3BuZy9jM2MxODUyMjcwY2EzNWZkNTYxMzVkOGZkYTJhOTk3Ny5wbmcnXG4gICAgfSxcbiAgfSxcblxuICAvKipcbiAgICog55Sf5ZG95ZGo5pyf5Ye95pWwLS3nm5HlkKzpobXpnaLliqDovb1cbiAgICovXG4gIG9uTG9hZDogZnVuY3Rpb24gKG9wdGlvbnM6IHsgbWFjOiBzdHJpbmcgfSkge1xuICAgIHRoaXMuc2V0RGF0YSh7XG4gICAgICBtYWM6IG9wdGlvbnMubWFjXG4gICAgfSlcbiAgICB0aGlzLnN0YXJ0KClcbiAgfSxcblxuICBhc3luYyBzdGFydCgpIHtcbiAgICBjb25zdCB7IGRhdGE6IHRlcm1pbmFsIH0gPSBhd2FpdCBhcGkuZ2V0VGVybWluYWwodGhpcy5kYXRhLm1hYylcbiAgICBjb25zdCBqdyA9IHRlcm1pbmFsLmp3ICYmIHRlcm1pbmFsLmp3Lmxlbmd0aCA+IDEwID8gdGVybWluYWwuancuc3BsaXQoJywnKSA6IGZhbHNlXG4gICAgLy8gY29uc29sZS5sb2coancpO1xuICAgIHRlcm1pbmFsLnVwdGltZSA9IHBhcnNlVGltZSh0ZXJtaW5hbC51cHRpbWUpXG4gICAgLy9cbiAgICBjb25zdCBkZXZzID0gdGVybWluYWwubW91bnREZXZzLm1hcCgoZGV2OmFueSApPT4ge1xuICAgICAgZGV2LnBpYyA9ICh0aGlzLmRhdGEuZGV2UGljcyBhcyBhbnkpW2Rldi5UeXBlXVxuICAgICAgcmV0dXJuIGRldlxuICAgIH0pXG4gICAgdGhpcy5zZXREYXRhKHtcbiAgICAgIHRlcm1pbmFsLFxuICAgICAgZHR1SXRlbTogZGV2cyxcbiAgICAgIGp3U3VwcG9ydDogQm9vbGVhbihqdyksXG4gICAgfSlcbiAgICBpZiAoancpIHtcbiAgICAgIGNvbnN0IG1hcmsgPSB7XG4gICAgICAgIGljb25QYXRoOiBcIi4uLy4uLy4uL2Fzc2VydC9tYXJrLnBuZ1wiLFxuICAgICAgICBsYXRpdHVkZTogTnVtYmVyKGp3WzFdKSxcbiAgICAgICAgbG9uZ2l0dWRlOiBOdW1iZXIoandbMF0pLFxuICAgICAgICB0aXRsZTogdGVybWluYWwubmFtZSxcbiAgICAgICAgd2lkdGg6IDUwLFxuICAgICAgICBoZWlnaHQ6IDUwXG4gICAgICB9XG4gICAgICB0aGlzLnNldERhdGEoe1xuICAgICAgICBsb25naXR1ZGU6IGp3WzBdLFxuICAgICAgICBsYXRpdHVkZTogandbMV0sXG4gICAgICAgIG1hcmtlcnM6IFttYXJrXVxuICAgICAgfSlcbiAgICAgIC8vIOagueaNrmdwc+iOt+WPluWcsOWdgFxuICAgICAgYXBpLmdldEdQU2FkZHJlc3MoW2p3WzFdLCBqd1swXV0uam9pbignLCcpKS50aGVuKCh7IGNvZGUsIGRhdGEsIG1zZyB9KSA9PiB7XG4gICAgICAgIGlmIChjb2RlKSB7XG4gICAgICAgICAgdGhpcy5zZXREYXRhKHtcbiAgICAgICAgICAgIGFkZHJlc3M6IGRhdGEuYWRkcmVzcyxcbiAgICAgICAgICAgIHJlY29tbWVuZDogZGF0YS5mb3JtYXR0ZWRfYWRkcmVzc2VzLnJlY29tbWVuZFxuICAgICAgICAgIH0pXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgd3guc2hvd1RvYXN0KHsgdGl0bGU6IG1zZyB9KVxuICAgICAgICB9XG4gICAgICB9KVxuICAgIH1cbiAgICB3eC5zZXROYXZpZ2F0aW9uQmFyVGl0bGUoeyB0aXRsZTogdGVybWluYWwubmFtZSB8fCB0ZXJtaW5hbC5EZXZNYWMgfSlcbiAgfSxcblxuICAvLyDmn6XnnIvorr7lpIfmlbDmja5cbiAgc2hvd01vdW50RGV2RGF0YShldmVudDogdmFudEV2ZW50PFVhcnQuVGVybWluYWxNb3VudERldnM+KSB7XG4gICAgY29uc3QgeyBwaWQsIG1vdW50RGV2LCBwcm90b2NvbCwgVHlwZSB9ID0gZXZlbnQuY3VycmVudFRhcmdldC5kYXRhc2V0Lml0ZW1cbiAgICBjb25zdCB7IERldk1hYyB9ID0gdGhpcy5kYXRhLnRlcm1pbmFsXG4gICAgd3gubmF2aWdhdGVUbyh7XG4gICAgICB1cmw6ICcvcGFnZXMvaW5kZXgvZGV2cy9kZXZzJyArIE9iamVjdFRvU3RycXVlcnkoeyBwaWQ6IFN0cmluZyhwaWQpLCBtb3VudERldiwgcHJvdG9jb2wsIERldk1hYywgVHlwZSB9KVxuICAgIH0pXG4gIH0sXG5cbiAgbWFya2VydGFwKF9lOiB2YW50RXZlbnQpIHtcbiAgICAvKiBjb25zdCBtYXAgPSB3eC5jcmVhdGVNYXBDb250ZXh0KGUuY3VycmVudFRhcmdldC5pZClcbiAgICBtYXAuZ2V0Q2VudGVyTG9jYXRpb24oe1xuICAgICAgc3VjY2VzcyhlMil7XG4gICAgICAgIGNvbnNvbGUubG9nKGUyKTtcbiAgICAgICAgXG4gICAgICB9XG4gICAgfSlcbiAgICBcbiAqL1xuICB9LFxuICAvL1xuICBhc3luYyBuYW1lQ2hhbmdlKGV2ZW50OiB2YW50RXZlbnQpIHtcbiAgICBjb25zdCB2YWx1ZSA9IGV2ZW50LmRldGFpbC52YWx1ZVxuICAgIGNvbnN0IHsgY29kZSwgbXNnIH0gPSBhd2FpdCBhcGkubW9kaWZ5VGVybWluYWwodGhpcy5kYXRhLnRlcm1pbmFsLkRldk1hYywgdmFsdWUpXG4gICAgaWYgKCFjb2RlKSB7XG4gICAgICB3eC5zaG93TW9kYWwoe1xuICAgICAgICB0aXRsZTogXCJFcnJvclwiLFxuICAgICAgICBjb250ZW50OiBtc2dcbiAgICAgIH0pXG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuc2V0RGF0YSh7XG4gICAgICAgIFwidGVybWluYWwubmFtZVwiOiB2YWx1ZVxuICAgICAgfSlcbiAgICAgIHd4LnNldFN0b3JhZ2Uoe1xuICAgICAgICBrZXk6IHRoaXMuZGF0YS50ZXJtaW5hbC5faWQgYXMgYW55LFxuICAgICAgICBkYXRhOiB0aGlzLmRhdGEudGVybWluYWxcbiAgICAgIH0pXG4gICAgfVxuICB9LFxuXG4gIC8vIFxuICAvLyB1cGRhdGVHcHMoKSB7XG4gIC8vICAgY29uc3Qgc2V0dXBHcHMgPSB0aGlzLnNldHVwR3BzXG4gIC8vICAgd3guc2hvd01vZGFsKHtcbiAgLy8gICAgIHRpdGxlOiAnVGlwJyxcbiAgLy8gICAgIGNvbnRlbnQ6ICfmmK/lkKbmiopEVFXlrprkvY3mm7TmlrDkuLrlvZPliY3lnLDlnYA/JyxcbiAgLy8gICAgIHN1Y2Nlc3Mob2spIHtcbiAgLy8gICAgICAgd3guc2hvd0xvYWRpbmcoe1xuICAvLyAgICAgICAgIHRpdGxlOiAn6K+356iN562JJ1xuICAvLyAgICAgICB9KVxuICAvLyAgICAgICBpZiAob2suY29uZmlybSkge1xuICAvLyAgICAgICAgIHd4LmdldFNldHRpbmcoe1xuICAvLyAgICAgICAgICAgc3VjY2VzcyhyZXMpIHtcbiAgLy8gICAgICAgICAgICAgaWYgKCFyZXMuYXV0aFNldHRpbmdbXCJzY29wZS51c2VyTG9jYXRpb25cIl0pIHtcblxuICAvLyAgICAgICAgICAgICAgIHd4LmF1dGhvcml6ZSh7XG4gIC8vICAgICAgICAgICAgICAgICBzY29wZTogXCJzY29wZS51c2VyTG9jYXRpb25cIixcbiAgLy8gICAgICAgICAgICAgICAgIHN1Y2Nlc3MoKSB7XG4gIC8vICAgICAgICAgICAgICAgICAgIHNldHVwR3BzKClcbiAgLy8gICAgICAgICAgICAgICAgIH1cbiAgLy8gICAgICAgICAgICAgICB9KVxuICAvLyAgICAgICAgICAgICB9IGVsc2Uge1xuICAvLyAgICAgICAgICAgICAgIHNldHVwR3BzKClcbiAgLy8gICAgICAgICAgICAgfVxuICAvLyAgICAgICAgICAgfVxuICAvLyAgICAgICAgIH0pXG4gIC8vICAgICAgIH1cbiAgLy8gICAgIH1cbiAgLy8gICB9KVxuICAvLyB9LFxuXG4gIC8vIOiuvue9rkdwc1xuICAvLyBzZXR1cEdwcygpIHtcbiAgLy8gICBjb25zdCB7IHRlcm1pbmFsIH0gPSB0aGlzLmRhdGFcbiAgLy8gICB3eC5nZXRMb2NhdGlvbih7XG4gIC8vICAgICBzdWNjZXNzOiAobG9jYXRpb24pID0+IHtcbiAgLy8gICAgICAgdGVybWluYWwuancgPSBbbG9jYXRpb24ubG9uZ2l0dWRlLnRvRml4ZWQoNSksIGxvY2F0aW9uLmxhdGl0dWRlLnRvRml4ZWQoNSldLmpvaW4oJywnKVxuICAvLyAgICAgICB3eC5oaWRlTG9hZGluZygpXG4gIC8vICAgICAgIHd4LnNldFN0b3JhZ2Uoe1xuICAvLyAgICAgICAgIGtleTogdGVybWluYWwuX2lkIGFzIGFueSxcbiAgLy8gICAgICAgICBkYXRhOiB0ZXJtaW5hbCxcbiAgLy8gICAgICAgICBzdWNjZXNzOiAoKSA9PiB7XG4gIC8vICAgICAgICAgICB0aGlzLnN0YXJ0KClcbiAgLy8gICAgICAgICB9XG4gIC8vICAgICAgIH0pXG4gIC8vICAgICAgIC8vIOS4iuS8oOWumuS9jeWIsOacjeWKoeerr1xuICAvLyAgICAgICBhcGkudXBkYXRlR3BzKHRlcm1pbmFsLkRldk1hYywgdGVybWluYWwuancpLnRoZW4oZWwgPT4ge1xuICAvLyAgICAgICAgIGlmIChlbC5jb2RlKSB7XG4gIC8vICAgICAgICAgICB3eC5zaG93VG9hc3QoeyB0aXRsZTogJ+abtOaWsOWumuS9jeaIkOWKnycgfSlcbiAgLy8gICAgICAgICB9IGVsc2Uge1xuICAvLyAgICAgICAgICAgd3guc2hvd1RvYXN0KHsgdGl0bGU6IGVsLm1zZywgaWNvbjogJ25vbmUnIH0pXG4gIC8vICAgICAgICAgfVxuICAvLyAgICAgICAgIHd4LmhpZGVMb2FkaW5nKClcbiAgLy8gICAgICAgfSlcbiAgLy8gICAgIH1cbiAgLy8gICB9KVxuICAvLyB9XG59KSJdfQ==