"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const util_1 = require("../../../utils/util");
const api_1 = require("../../../utils/api");
Page({
    data: {
        mac: '',
        terminal: {},
        dtuItem: [],
        jwSupport: false,
        longitude: '',
        latitude: '',
        markers: [],
        address: '',
        recommend: '',
        devPics: {
            "UPS": 'https://besiv-uart.oss-cn-hangzhou.aliyuncs.com/png/99daa3e07c7b60ef7e16ed8b9fe7cf33.png',
            "温湿度": 'https://besiv-uart.oss-cn-hangzhou.aliyuncs.com/png/5fc7d6fe0571b714d5a3395a8c7a9f12.png',
            "电量仪": 'https://besiv-uart.oss-cn-hangzhou.aliyuncs.com/png/ab52d9fccdddc0fa5b0386ea0b5cbc7f.png',
            "空调": 'https://besiv-uart.oss-cn-hangzhou.aliyuncs.com/png/c3c1852270ca35fd56135d8fda2a9977.png'
        },
    },
    onLoad: function (options) {
        this.setData({
            mac: options.mac
        });
        this.start();
    },
    async start() {
        const { data: terminal } = await api_1.default.getTerminal(this.data.mac);
        const jw = terminal.jw && terminal.jw.length > 10 ? terminal.jw.split(',') : false;
        terminal.uptime = (0, util_1.parseTime)(terminal.uptime);
        const devs = terminal.mountDevs.map((dev) => {
            dev.pic = this.data.devPics[dev.Type];
            return dev;
        });
        this.setData({
            terminal,
            dtuItem: devs,
            jwSupport: Boolean(jw),
        });
        if (jw) {
            const mark = {
                iconPath: "../../../assert/mark.png",
                latitude: Number(jw[1]),
                longitude: Number(jw[0]),
                title: terminal.name,
                width: 50,
                height: 50
            };
            this.setData({
                longitude: jw[0],
                latitude: jw[1],
                markers: [mark]
            });
            api_1.default.getGPSaddress([jw[1], jw[0]].join(',')).then(({ code, data, msg }) => {
                if (code) {
                    this.setData({
                        address: data.address,
                        recommend: data.formatted_addresses.recommend
                    });
                }
                else {
                    wx.showToast({ title: msg });
                }
            });
        }
        wx.setNavigationBarTitle({ title: terminal.name || terminal.DevMac });
    },
    showMountDevData(event) {
        const { pid, mountDev, protocol, Type } = event.currentTarget.dataset.item;
        const { DevMac } = this.data.terminal;
        wx.navigateTo({
            url: '/pages/index/devs/devs' + (0, util_1.ObjectToStrquery)({ pid: String(pid), mountDev, protocol, DevMac, Type })
        });
    },
    markertap(_e) {
    },
    async nameChange(event) {
        const value = event.detail.value;
        const { code, msg } = await api_1.default.modifyTerminal(this.data.terminal.DevMac, value);
        if (!code) {
            wx.showModal({
                title: "Error",
                content: msg
            });
        }
        else {
            this.setData({
                "terminal.name": value
            });
            wx.setStorage({
                key: this.data.terminal._id,
                data: this.data.terminal
            });
        }
    },
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZHR1LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiZHR1LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7O0FBQUEsOENBQWlFO0FBQ2pFLDRDQUFvQztBQUdwQyxJQUFJLENBQUM7SUFLSCxJQUFJLEVBQUU7UUFDSixHQUFHLEVBQUUsRUFBRTtRQUNQLFFBQVEsRUFBRSxFQUFtQjtRQUM3QixPQUFPLEVBQUUsRUFBOEI7UUFDdkMsU0FBUyxFQUFFLEtBQUs7UUFDaEIsU0FBUyxFQUFFLEVBQUU7UUFDYixRQUFRLEVBQUUsRUFBRTtRQUNaLE9BQU8sRUFBRSxFQUFXO1FBQ3BCLE9BQU8sRUFBRSxFQUFFO1FBQ1gsU0FBUyxFQUFFLEVBQUU7UUFDYixPQUFPLEVBQUU7WUFDUCxLQUFLLEVBQUUsMEZBQTBGO1lBQ2pHLEtBQUssRUFBRSwwRkFBMEY7WUFDakcsS0FBSyxFQUFFLDBGQUEwRjtZQUNqRyxJQUFJLEVBQUUsMEZBQTBGO1NBQ2pHO0tBQ0Y7SUFLRCxNQUFNLEVBQUUsVUFBVSxPQUF3QjtRQUN4QyxJQUFJLENBQUMsT0FBTyxDQUFDO1lBQ1gsR0FBRyxFQUFFLE9BQU8sQ0FBQyxHQUFHO1NBQ2pCLENBQUMsQ0FBQTtRQUNGLElBQUksQ0FBQyxLQUFLLEVBQUUsQ0FBQTtJQUNkLENBQUM7SUFFRCxLQUFLLENBQUMsS0FBSztRQUNULE1BQU0sRUFBRSxJQUFJLEVBQUUsUUFBUSxFQUFFLEdBQUcsTUFBTSxhQUFHLENBQUMsV0FBVyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUE7UUFDL0QsTUFBTSxFQUFFLEdBQUcsUUFBUSxDQUFDLEVBQUUsSUFBSSxRQUFRLENBQUMsRUFBRSxDQUFDLE1BQU0sR0FBRyxFQUFFLENBQUMsQ0FBQyxDQUFDLFFBQVEsQ0FBQyxFQUFFLENBQUMsS0FBSyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQyxLQUFLLENBQUE7UUFFbEYsUUFBUSxDQUFDLE1BQU0sR0FBRyxJQUFBLGdCQUFT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TUFBTSxhQUFHLENBQUMsY0FBYyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsUUFBUSxDQUFDLE1BQU0sRUFBRSxLQUFLLENBQUMsQ0FBQTtRQUNoRixJQUFJLENBQUMsSUFBSSxFQUFFLENBQUM7WUFDVixFQUFFLENBQUMsU0FBUyxDQUFDO2dCQUNYLEtBQUssRUFBRSxPQUFPO2dCQUNkLE9BQU8sRUFBRSxHQUFHO2FBQ2IsQ0FBQyxDQUFBO1FBQ0osQ0FBQzthQUFNLENBQUM7WUFDTixJQUFJLENBQUMsT0FBTyxDQUFDO2dCQUNYLGVBQWUsRUFBRSxLQUFLO2FBQ3ZCLENBQUMsQ0FBQTtZQUNGLEVBQUUsQ0FBQyxVQUFVLENBQUM7Z0JBQ1osR0FBRyxFQUFFLElBQUksQ0FBQyxJQUFJLENBQUMsUUFBUSxDQUFDLEdBQVU7Z0JBQ2xDLElBQUksRUFBRSxJQUFJLENBQUMsSUFBSSxDQUFDLFFBQVE7YUFDekIsQ0FBQyxDQUFBO1FBQ0osQ0FBQztJQUNILENBQUM7Q0EyREYsQ0FBQyxDQUFBIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgT2JqZWN0VG9TdHJxdWVyeSwgcGFyc2VUaW1lIH0gZnJvbSBcIi4uLy4uLy4uL3V0aWxzL3V0aWxcIlxuaW1wb3J0IGFwaSBmcm9tIFwiLi4vLi4vLi4vdXRpbHMvYXBpXCJcblxuLy8gbWluaXByb2dyYW0vcGFnZXMvaW5kZXgvZHR1L2R0dS5qc1xuUGFnZSh7XG5cbiAgLyoqXG4gICAqIOmhtemdoueahOWIneWni+aVsOaNrlxuICAgKi9cbiAgZGF0YToge1xuICAgIG1hYzogJycsXG4gICAgdGVybWluYWw6IHt9IGFzIFVhcnQuVGVybWluYWwsXG4gICAgZHR1SXRlbTogW10gYXMgVWFydC5UZXJtaW5hbE1vdW50RGV2c1tdLFxuICAgIGp3U3VwcG9ydDogZmFsc2UsXG4gICAgbG9uZ2l0dWRlOiAnJyxcbiAgICBsYXRpdHVkZTogJycsXG4gICAgbWFya2VyczogW10gYXMgYW55W10sXG4gICAgYWRkcmVzczogJycsXG4gICAgcmVjb21tZW5kOiAnJyxcbiAgICBkZXZQaWNzOiB7XG4gICAgICBcIlVQU1wiOiAnaHR0cHM6Ly9iZXNpdi11YXJ0Lm9zcy1jbi1oYW5nemhvdS5hbGl5dW5jcy5jb20vcG5nLzk5ZGFhM2UwN2M3YjYwZWY3ZTE2ZWQ4YjlmZTdjZjMzLnBuZycsXG4gICAgICBcIua4qea5v+W6plwiOiAnaHR0cHM6Ly9iZXNpdi11YXJ0Lm9zcy1jbi1oYW5nemhvdS5hbGl5dW5jcy5jb20vcG5nLzVmYzdkNmZlMDU3MWI3MTRkNWEzMzk1YThjN2E5ZjEyLnBuZycsXG4gICAgICBcIueUtemHj+S7qlwiOiAnaHR0cHM6Ly9iZXNpdi11YXJ0Lm9zcy1jbi1oYW5nemhvdS5hbGl5dW5jcy5jb20vcG5nL2FiNTJkOWZjY2RkZGMwZmE1YjAzODZlYTBiNWNiYzdmLnBuZycsXG4gICAgICBcIuepuuiwg1wiOiAnaHR0cHM6Ly9iZXNpdi11YXJ0Lm9zcy1jbi1oYW5nemhvdS5hbGl5dW5jcy5jb20vcG5nL2MzYzE4NTIyNzBjYTM1ZmQ1NjEzNWQ4ZmRhMmE5OTc3LnBuZydcbiAgICB9LFxuICB9LFxuXG4gIC8qKlxuICAgKiDnlJ/lkb3lkajmnJ/lh73mlbAtLeebkeWQrOmhtemdouWKoOi9vVxuICAgKi9cbiAgb25Mb2FkOiBmdW5jdGlvbiAob3B0aW9uczogeyBtYWM6IHN0cmluZyB9KSB7XG4gICAgdGhpcy5zZXREYXRhKHtcbiAgICAgIG1hYzogb3B0aW9ucy5tYWNcbiAgICB9KVxuICAgIHRoaXMuc3RhcnQoKVxuICB9LFxuXG4gIGFzeW5jIHN0YXJ0KCkge1xuICAgIGNvbnN0IHsgZGF0YTogdGVybWluYWwgfSA9IGF3YWl0IGFwaS5nZXRUZXJtaW5hbCh0aGlzLmRhdGEubWFjKVxuICAgIGNvbnN0IGp3ID0gdGVybWluYWwuancgJiYgdGVybWluYWwuancubGVuZ3RoID4gMTAgPyB0ZXJtaW5hbC5qdy5zcGxpdCgnLCcpIDogZmFsc2VcbiAgICAvLyBjb25zb2xlLmxvZyhqdyk7XG4gICAgdGVybWluYWwudXB0aW1lID0gcGFyc2VUaW1lKHRlcm1pbmFsLnVwdGltZSlcbiAgICAvL1xuICAgIGNvbnN0IGRldnMgPSB0ZXJtaW5hbC5tb3VudERldnMubWFwKChkZXY6YW55ICk9PiB7XG4gICAgICBkZXYucGljID0gKHRoaXMuZGF0YS5kZXZQaWNzIGFzIGFueSlbZGV2LlR5cGVdXG4gICAgICByZXR1cm4gZGV2XG4gICAgfSlcbiAgICB0aGlzLnNldERhdGEoe1xuICAgICAgdGVybWluYWwsXG4gICAgICBkdHVJdGVtOiBkZXZzLFxuICAgICAgandTdXBwb3J0OiBCb29sZWFuKGp3KSxcbiAgICB9KVxuICAgIGlmIChqdykge1xuICAgICAgY29uc3QgbWFyayA9IHtcbiAgICAgICAgaWNvblBhdGg6IFwiLi4vLi4vLi4vYXNzZXJ0L21hcmsucG5nXCIsXG4gICAgICAgIGxhdGl0dWRlOiBOdW1iZXIoandbMV0pLFxuICAgICAgICBsb25naXR1ZGU6IE51bWJlcihqd1swXSksXG4gICAgICAgIHRpdGxlOiB0ZXJtaW5hbC5uYW1lLFxuICAgICAgICB3aWR0aDogNTAsXG4gICAgICAgIGhlaWdodDogNTBcbiAgICAgIH1cbiAgICAgIHRoaXMuc2V0RGF0YSh7XG4gICAgICAgIGxvbmdpdHVkZTogandbMF0sXG4gICAgICAgIGxhdGl0dWRlOiBqd1sxXSxcbiAgICAgICAgbWFya2VyczogW21hcmtdXG4gICAgICB9KVxuICAgICAgLy8g5qC55o2uZ3Bz6I635Y+W5Zyw5Z2AXG4gICAgICBhcGkuZ2V0R1BTYWRkcmVzcyhbandbMV0sIGp3WzBdXS5qb2luKCcsJykpLnRoZW4oKHsgY29kZSwgZGF0YSwgbXNnIH0pID0+IHtcbiAgICAgICAgaWYgKGNvZGUpIHtcbiAgICAgICAgICB0aGlzLnNldERhdGEoe1xuICAgICAgICAgICAgYWRkcmVzczogZGF0YS5hZGRyZXNzLFxuICAgICAgICAgICAgcmVjb21tZW5kOiBkYXRhLmZvcm1hdHRlZF9hZGRyZXNzZXMucmVjb21tZW5kXG4gICAgICAgICAgfSlcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB3eC5zaG93VG9hc3QoeyB0aXRsZTogbXNnIH0pXG4gICAgICAgIH1cbiAgICAgIH0pXG4gICAgfVxuICAgIHd4LnNldE5hdmlnYXRpb25CYXJUaXRsZSh7IHRpdGxlOiB0ZXJtaW5hbC5uYW1lIHx8IHRlcm1pbmFsLkRldk1hYyB9KVxuICB9LFxuXG4gIC8vIOafpeeci+iuvuWkh+aVsOaNrlxuICBzaG93TW91bnREZXZEYXRhKGV2ZW50OiB2YW50RXZlbnQ8VWFydC5UZXJtaW5hbE1vdW50RGV2cz4pIHtcbiAgICBjb25zdCB7IHBpZCwgbW91bnREZXYsIHByb3RvY29sLCBUeXBlIH0gPSBldmVudC5jdXJyZW50VGFyZ2V0LmRhdGFzZXQuaXRlbVxuICAgIGNvbnN0IHsgRGV2TWFjIH0gPSB0aGlzLmRhdGEudGVybWluYWxcbiAgICB3eC5uYXZpZ2F0ZVRvKHtcbiAgICAgIHVybDogJy9wYWdlcy9pbmRleC9kZXZzL2RldnMnICsgT2JqZWN0VG9TdHJxdWVyeSh7IHBpZDogU3RyaW5nKHBpZCksIG1vdW50RGV2LCBwcm90b2NvbCwgRGV2TWFjLCBUeXBlIH0pXG4gICAgfSlcbiAgfSxcblxuICBtYXJrZXJ0YXAoX2U6IHZhbnRFdmVudCkge1xuICAgIC8qIGNvbnN0IG1hcCA9IHd4LmNyZWF0ZU1hcENvbnRleHQoZS5jdXJyZW50VGFyZ2V0LmlkKVxuICAgIG1hcC5nZXRDZW50ZXJMb2NhdGlvbih7XG4gICAgICBzdWNjZXNzKGUyKXtcbiAgICAgICAgY29uc29sZS5sb2coZTIpO1xuICAgICAgICBcbiAgICAgIH1cbiAgICB9KVxuICAgIFxuICovXG4gIH0sXG4gIC8vXG4gIGFzeW5jIG5hbWVDaGFuZ2UoZXZlbnQ6IHZhbnRFdmVudCkge1xuICAgIGNvbnN0IHZhbHVlID0gZXZlbnQuZGV0YWlsLnZhbHVlXG4gICAgY29uc3QgeyBjb2RlLCBtc2cgfSA9IGF3YWl0IGFwaS5tb2RpZnlUZXJtaW5hbCh0aGlzLmRhdGEudGVybWluYWwuRGV2TWFjLCB2YWx1ZSlcbiAgICBpZiAoIWNvZGUpIHtcbiAgICAgIHd4LnNob3dNb2RhbCh7XG4gICAgICAgIHRpdGxlOiBcIkVycm9yXCIsXG4gICAgICAgIGNvbnRlbnQ6IG1zZ1xuICAgICAgfSlcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5zZXREYXRhKHtcbiAgICAgICAgXCJ0ZXJtaW5hbC5uYW1lXCI6IHZhbHVlXG4gICAgICB9KVxuICAgICAgd3guc2V0U3RvcmFnZSh7XG4gICAgICAgIGtleTogdGhpcy5kYXRhLnRlcm1pbmFsLl9pZCBhcyBhbnksXG4gICAgICAgIGRhdGE6IHRoaXMuZGF0YS50ZXJtaW5hbFxuICAgICAgfSlcbiAgICB9XG4gIH0sXG5cbiAgLy8gXG4gIC8vIHVwZGF0ZUdwcygpIHtcbiAgLy8gICBjb25zdCBzZXR1cEdwcyA9IHRoaXMuc2V0dXBHcHNcbiAgLy8gICB3eC5zaG93TW9kYWwoe1xuICAvLyAgICAgdGl0bGU6ICdUaXAnLFxuICAvLyAgICAgY29udGVudDogJ+aYr+WQpuaKikRUVeWumuS9jeabtOaWsOS4uuW9k+WJjeWcsOWdgD8nLFxuICAvLyAgICAgc3VjY2Vzcyhvaykge1xuICAvLyAgICAgICB3eC5zaG93TG9hZGluZyh7XG4gIC8vICAgICAgICAgdGl0bGU6ICfor7fnqI3nrYknXG4gIC8vICAgICAgIH0pXG4gIC8vICAgICAgIGlmIChvay5jb25maXJtKSB7XG4gIC8vICAgICAgICAgd3guZ2V0U2V0dGluZyh7XG4gIC8vICAgICAgICAgICBzdWNjZXNzKHJlcykge1xuICAvLyAgICAgICAgICAgICBpZiAoIXJlcy5hdXRoU2V0dGluZ1tcInNjb3BlLnVzZXJMb2NhdGlvblwiXSkge1xuXG4gIC8vICAgICAgICAgICAgICAgd3guYXV0aG9yaXplKHtcbiAgLy8gICAgICAgICAgICAgICAgIHNjb3BlOiBcInNjb3BlLnVzZXJMb2NhdGlvblwiLFxuICAvLyAgICAgICAgICAgICAgICAgc3VjY2VzcygpIHtcbiAgLy8gICAgICAgICAgICAgICAgICAgc2V0dXBHcHMoKVxuICAvLyAgICAgICAgICAgICAgICAgfVxuICAvLyAgICAgICAgICAgICAgIH0pXG4gIC8vICAgICAgICAgICAgIH0gZWxzZSB7XG4gIC8vICAgICAgICAgICAgICAgc2V0dXBHcHMoKVxuICAvLyAgICAgICAgICAgICB9XG4gIC8vICAgICAgICAgICB9XG4gIC8vICAgICAgICAgfSlcbiAgLy8gICAgICAgfVxuICAvLyAgICAgfVxuICAvLyAgIH0pXG4gIC8vIH0sXG5cbiAgLy8g6K6+572uR3BzXG4gIC8vIHNldHVwR3BzKCkge1xuICAvLyAgIGNvbnN0IHsgdGVybWluYWwgfSA9IHRoaXMuZGF0YVxuICAvLyAgIHd4LmdldExvY2F0aW9uKHtcbiAgLy8gICAgIHN1Y2Nlc3M6IChsb2NhdGlvbikgPT4ge1xuICAvLyAgICAgICB0ZXJtaW5hbC5qdyA9IFtsb2NhdGlvbi5sb25naXR1ZGUudG9GaXhlZCg1KSwgbG9jYXRpb24ubGF0aXR1ZGUudG9GaXhlZCg1KV0uam9pbignLCcpXG4gIC8vICAgICAgIHd4LmhpZGVMb2FkaW5nKClcbiAgLy8gICAgICAgd3guc2V0U3RvcmFnZSh7XG4gIC8vICAgICAgICAga2V5OiB0ZXJtaW5hbC5faWQgYXMgYW55LFxuICAvLyAgICAgICAgIGRhdGE6IHRlcm1pbmFsLFxuICAvLyAgICAgICAgIHN1Y2Nlc3M6ICgpID0+IHtcbiAgLy8gICAgICAgICAgIHRoaXMuc3RhcnQoKVxuICAvLyAgICAgICAgIH1cbiAgLy8gICAgICAgfSlcbiAgLy8gICAgICAgLy8g5LiK5Lyg5a6a5L2N5Yiw5pyN5Yqh56uvXG4gIC8vICAgICAgIGFwaS51cGRhdGVHcHModGVybWluYWwuRGV2TWFjLCB0ZXJtaW5hbC5qdykudGhlbihlbCA9PiB7XG4gIC8vICAgICAgICAgaWYgKGVsLmNvZGUpIHtcbiAgLy8gICAgICAgICAgIHd4LnNob3dUb2FzdCh7IHRpdGxlOiAn5pu05paw5a6a5L2N5oiQ5YqfJyB9KVxuICAvLyAgICAgICAgIH0gZWxzZSB7XG4gIC8vICAgICAgICAgICB3eC5zaG93VG9hc3QoeyB0aXRsZTogZWwubXNnLCBpY29uOiAnbm9uZScgfSlcbiAgLy8gICAgICAgICB9XG4gIC8vICAgICAgICAgd3guaGlkZUxvYWRpbmcoKVxuICAvLyAgICAgICB9KVxuICAvLyAgICAgfVxuICAvLyAgIH0pXG4gIC8vIH1cbn0pIl19