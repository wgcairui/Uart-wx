"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const util_1 = require("../../../utils/util");
const api_1 = require("../../../utils/api");
Page({
    data: {
        id: '',
        dev: {
            id: '',
            mountDev: '',
            Type: '',
            pid: 0,
            protocol: ''
        }
    },
    async scanMac() {
        const scanResult = await wx.scanCode({});
        this.setData({
            id: scanResult.result
        });
        this.scanRequst();
    },
    async scanRequst() {
        wx.showLoading({ title: '查询中' });
        const { code, data } = await api_1.default.getRegisterDev(this.data.id);
        wx.hideLoading();
        if (code && data) {
            data.timeStamp = (0, util_1.parseTime)(data.timeStamp);
            this.setData({
                dev: data
            });
        }
        else {
            wx.showModal({
                title: 'search',
                content: '此设备没有注册，请核对设备是否在我司渠道购买'
            });
        }
    },
    async delRegisterDev() {
        const { confirm } = await wx.showModal({
            title: '删除设备',
            content: `确定删除${this.data.dev.id} ???`
        });
        if (confirm) {
            wx.showLoading({ title: "loading" });
            const { code, msg } = await api_1.default.delRegisterDev(this.data.dev.id);
            wx.hideLoading();
            if (code) {
                wx.showModal({
                    title: 'success',
                    content: '已删除',
                    success() {
                        wx.navigateBack();
                    }
                });
            }
            else {
                wx.showModal({
                    title: 'error',
                    content: msg
                });
            }
        }
    }
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZGV2LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiZGV2LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7O0FBQ0EsOENBQStDO0FBQy9DLDRDQUFvQztBQUNwQyxJQUFJLENBQUM7SUFDSCxJQUFJLEVBQUU7UUFDSixFQUFFLEVBQUUsRUFBRTtRQUNOLEdBQUcsRUFBRTtZQUNILEVBQUUsRUFBRSxFQUFFO1lBQ04sUUFBUSxFQUFFLEVBQUU7WUFDWixJQUFJLEVBQUUsRUFBRTtZQUNSLEdBQUcsRUFBRSxDQUFDO1lBQ04sUUFBUSxFQUFFLEVBQUU7U0FDTztLQUN0QjtJQUVELEtBQUssQ0FBQyxPQUFPO1FBQ1gsTUFBTSxVQUFVLEdBQUcsTUFBTSxFQUFFLENBQUMsUUFBUSxDQUFDLEVBQUUsQ0FBQyxDQUFBO1FBQ3hDLElBQUksQ0FBQyxPQUFPLENBQUM7WUFDWCxFQUFFLEVBQUUsVUFBVSxDQUFDLE1BQU07U0FDdEIsQ0FBQyxDQUFBO1FBQ0YsSUFBSSxDQUFDLFVBQVUsRUFBRSxDQUFBO0lBQ25CLENBQUM7SUFFRCxLQUFLLENBQUMsVUFBVTtRQUNkLEVBQUUsQ0FBQyxXQUFXLENBQUMsRUFBRSxLQUFLLEVBQUUsS0FBSyxFQUFFLENBQUMsQ0FBQTtRQUNoQyxNQUFNLEVBQUUsSUFBSSxFQUFFLElBQUksRUFBRSxHQUFHLE1BQU0sYUFBRyxDQUFDLGNBQWMsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxDQUFBO1FBQzdELEVBQUUsQ0FBQyxXQUFXLEVBQUUsQ0FBQTtRQUNoQixJQUFJLElBQUksSUFBSSxJQUFJLEVBQUUsQ0FBQztZQUNoQixJQUFZLENBQUMsU0FBUyxHQUFHLElBQUEsZ0JBQVMsRUFBRSxJQUFZLENBQUMsU0FBUyxDQUFDLENBQUE7WUFDNUQsSUFBSSxDQUFDLE9BQU8sQ0FBQztnQkFDWCxHQUFHLEVBQUUsSUFBSTthQUNWLENBQUMsQ0FBQTtRQUNKLENBQUM7YUFBTSxDQUFDO1lBQ04sRUFBRSxDQUFDLFNBQVMsQ0FBQztnQkFDWCxLQUFLLEVBQUUsUUFBUTtnQkFDZixPQUFPLEVBQUUsd0JBQXdCO2FBQ2xDLENBQUMsQ0FBQTtRQUNKLENBQUM7SUFDSCxDQUFDO0lBR0QsS0FBSyxDQUFDLGNBQWM7UUFDbEIsTUFBTSxFQUFFLE9BQU8sRUFBRSxHQUFHLE1BQU0sRUFBRSxDQUFDLFNBQVMsQ0FBQztZQUNyQyxLQUFLLEVBQUUsTUFBTTtZQUNiLE9BQU8sRUFBRSxPQUFPLElBQUksQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLEVBQUUsTUFBTTtTQUN2QyxDQUFDLENBQUE7UUFFRixJQUFJLE9BQU8sRUFBRSxDQUFDO1lBQ1osRUFBRSxDQUFDLFdBQVcsQ0FBQyxFQUFFLEtBQUssRUFBRSxTQUFTLEVBQUUsQ0FBQyxDQUFBO1lBQ3BDLE1BQU0sRUFBRSxJQUFJLEVBQUUsR0FBRyxFQUFFLEdBQUcsTUFBTSxhQUFHLENBQUMsY0FBYyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxDQUFBO1lBQ2hFLEVBQUUsQ0FBQyxXQUFXLEVBQUUsQ0FBQTtZQUNoQixJQUFJLElBQUksRUFBRSxDQUFDO2dCQUNULEVBQUUsQ0FBQyxTQUFTLENBQUM7b0JBQ1gsS0FBSyxFQUFFLFNBQVM7b0JBQ2hCLE9BQU8sRUFBRSxLQUFLO29CQUNkLE9BQU87d0JBQ0wsRUFBRSxDQUFDLFlBQVksRUFBRSxDQUFBO29CQUNuQixDQUFDO2lCQUNGLENBQUMsQ0FBQTtZQUNKLENBQUM7aUJBQU0sQ0FBQztnQkFDTixFQUFFLENBQUMsU0FBUyxDQUFDO29CQUNYLEtBQUssRUFBRSxPQUFPO29CQUNkLE9BQU8sRUFBRSxHQUFHO2lCQUNiLENBQUMsQ0FBQTtZQUNKLENBQUM7UUFDSCxDQUFDO0lBQ0gsQ0FBQztDQUNGLENBQUMsQ0FBQSIsInNvdXJjZXNDb250ZW50IjpbIlxuaW1wb3J0IHsgcGFyc2VUaW1lIH0gZnJvbSBcIi4uLy4uLy4uL3V0aWxzL3V0aWxcIlxuaW1wb3J0IGFwaSBmcm9tIFwiLi4vLi4vLi4vdXRpbHMvYXBpXCJcblBhZ2Uoe1xuICBkYXRhOiB7XG4gICAgaWQ6ICcnLFxuICAgIGRldjoge1xuICAgICAgaWQ6ICcnLFxuICAgICAgbW91bnREZXY6ICcnLFxuICAgICAgVHlwZTogJycsXG4gICAgICBwaWQ6IDAsXG4gICAgICBwcm90b2NvbDogJydcbiAgICB9IGFzIFVhcnQucmVnaXN0ZXJEZXZcbiAgfSxcbiAgLy8g6LCD55So5b6u5L+hYXBp77yM5omr5o+PRFRV5p2h5b2i56CBXG4gIGFzeW5jIHNjYW5NYWMoKSB7XG4gICAgY29uc3Qgc2NhblJlc3VsdCA9IGF3YWl0IHd4LnNjYW5Db2RlKHt9KVxuICAgIHRoaXMuc2V0RGF0YSh7XG4gICAgICBpZDogc2NhblJlc3VsdC5yZXN1bHRcbiAgICB9KVxuICAgIHRoaXMuc2NhblJlcXVzdCgpXG4gIH0sXG4gIC8vIOafpeivokRUVeiuvuWkh+S/oeaBr1xuICBhc3luYyBzY2FuUmVxdXN0KCkge1xuICAgIHd4LnNob3dMb2FkaW5nKHsgdGl0bGU6ICfmn6Xor6LkuK0nIH0pXG4gICAgY29uc3QgeyBjb2RlLCBkYXRhIH0gPSBhd2FpdCBhcGkuZ2V0UmVnaXN0ZXJEZXYodGhpcy5kYXRhLmlkKVxuICAgIHd4LmhpZGVMb2FkaW5nKClcbiAgICBpZiAoY29kZSAmJiBkYXRhKSB7XG4gICAgICAoZGF0YSBhcyBhbnkpLnRpbWVTdGFtcCA9IHBhcnNlVGltZSgoZGF0YSBhcyBhbnkpLnRpbWVTdGFtcClcbiAgICAgIHRoaXMuc2V0RGF0YSh7XG4gICAgICAgIGRldjogZGF0YVxuICAgICAgfSlcbiAgICB9IGVsc2Uge1xuICAgICAgd3guc2hvd01vZGFsKHtcbiAgICAgICAgdGl0bGU6ICdzZWFyY2gnLFxuICAgICAgICBjb250ZW50OiAn5q2k6K6+5aSH5rKh5pyJ5rOo5YaM77yM6K+35qC45a+56K6+5aSH5piv5ZCm5Zyo5oiR5Y+45rig6YGT6LSt5LmwJ1xuICAgICAgfSlcbiAgICB9XG4gIH0sXG5cbiAgLy8g5Yig6Zmk5rOo5YaM6K6+5aSHXG4gIGFzeW5jIGRlbFJlZ2lzdGVyRGV2KCkge1xuICAgIGNvbnN0IHsgY29uZmlybSB9ID0gYXdhaXQgd3guc2hvd01vZGFsKHtcbiAgICAgIHRpdGxlOiAn5Yig6Zmk6K6+5aSHJyxcbiAgICAgIGNvbnRlbnQ6IGDnoa7lrprliKDpmaQke3RoaXMuZGF0YS5kZXYuaWR9ID8/P2BcbiAgICB9KVxuXG4gICAgaWYgKGNvbmZpcm0pIHtcbiAgICAgIHd4LnNob3dMb2FkaW5nKHsgdGl0bGU6IFwibG9hZGluZ1wiIH0pXG4gICAgICBjb25zdCB7IGNvZGUsIG1zZyB9ID0gYXdhaXQgYXBpLmRlbFJlZ2lzdGVyRGV2KHRoaXMuZGF0YS5kZXYuaWQpXG4gICAgICB3eC5oaWRlTG9hZGluZygpXG4gICAgICBpZiAoY29kZSkge1xuICAgICAgICB3eC5zaG93TW9kYWwoe1xuICAgICAgICAgIHRpdGxlOiAnc3VjY2VzcycsXG4gICAgICAgICAgY29udGVudDogJ+W3suWIoOmZpCcsXG4gICAgICAgICAgc3VjY2VzcygpIHtcbiAgICAgICAgICAgIHd4Lm5hdmlnYXRlQmFjaygpXG4gICAgICAgICAgfVxuICAgICAgICB9KVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgd3guc2hvd01vZGFsKHtcbiAgICAgICAgICB0aXRsZTogJ2Vycm9yJyxcbiAgICAgICAgICBjb250ZW50OiBtc2dcbiAgICAgICAgfSlcbiAgICAgIH1cbiAgICB9XG4gIH1cbn0pIl19