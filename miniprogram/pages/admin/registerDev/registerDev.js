"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const api_1 = require("../../../utils/api");
Page({
    data: {
        id: '',
        ids: [],
        devType: 'UPS',
        devTypes: [{ text: 'UPS', value: 'UPS' }, { text: '空调', value: '空调' }, { text: '电量仪', value: '电量仪' }, { text: '温湿度', value: '温湿度' }, { text: 'IO', value: 'IO' }],
        devModal: '',
        devModals: [],
        devModesMap: new Map(),
        devProtocol: '',
        devProtocols: [],
        pid: 1
    },
    onLoad: function () {
        this.devTypeChange();
    },
    async devTypeChange() {
        const { data } = await api_1.default.getDevTypes(this.data.devType);
        const devModals = data.map(el => ({ text: el.DevModel, value: el.DevModel }));
        this.setData({
            devModals,
            devProtocols: [],
            devModesMap: new Map(data.map(el => [el.DevModel, el]))
        });
    },
    async devModalChange() {
        const { devModesMap, devModal } = this.data;
        const devProtocols = devModesMap.get(devModal)?.Protocols.map(el => ({ text: el.Protocol, value: el.Protocol }));
        this.setData({
            devProtocols
        });
    },
    async scanMac() {
        const scanResult = await wx.scanCode({});
        this.setData({
            id: scanResult.result
        });
        this.scanRequst();
    },
    async scanRequst() {
        wx.showLoading({ title: '查询中' });
        const r = await api_1.default.getRegisterDev(this.data.id);
        wx.hideLoading();
        if (r.code && r.data) {
            wx.showModal({
                title: '重复注册',
                content: `设备${r.data.id}/${r.data.mountDev}已被注册`
            });
        }
        else
            this.setData({
                ids: [...new Set([...this.data.ids, this.data.id])]
            });
    },
    rmid(event) {
        const mac = event.currentTarget.dataset.key;
        wx.showModal({
            title: '删除Id',
            content: `确定删除Id:${mac} ??`,
            success: (res) => {
                if (res.confirm) {
                    this.setData({
                        ids: this.data.ids.filter(el => el !== mac)
                    });
                }
            }
        });
    },
    async submit() {
        const { ids, pid, devModal, devProtocol, devType } = this.data;
        if (ids.length === 0 || !pid || !devProtocol || !devModal || !devType) {
            wx.showModal({
                title: '校验错误',
                content: "缺少参数"
            });
            return;
        }
        const mountDev = {
            Type: devType,
            mountDev: devModal,
            pid,
            protocol: devProtocol
        };
        const res = await wx.showModal({
            title: '登记设备',
            content: `确认参数[${mountDev.mountDev}]/[${mountDev.protocol}]/[${mountDev.pid}] !!!`
        });
        if (res.confirm) {
            wx.showLoading({ title: '正在登记' });
            const r = await api_1.default.addRegisterDev(ids, mountDev);
            wx.hideLoading();
            if (r.code) {
                wx.showModal({
                    title: 'success',
                    content: `成功注册设备${r.data.length}个`
                });
                this.setData({
                    id: '',
                    ids: []
                });
            }
        }
    },
    onReady: function () {
    },
    onShow: function () {
    },
    onHide: function () {
    },
    onUnload: function () {
    },
    onPullDownRefresh: function () {
    },
    onReachBottom: function () {
    },
    onShareAppMessage: function () {
    }
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicmVnaXN0ZXJEZXYuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJyZWdpc3RlckRldi50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUFBLDRDQUFvQztBQVNwQyxJQUFJLENBQUM7SUFLSCxJQUFJLEVBQUU7UUFDSixFQUFFLEVBQUUsRUFBRTtRQUNOLEdBQUcsRUFBRSxFQUFjO1FBQ25CLE9BQU8sRUFBRSxLQUFLO1FBQ2QsUUFBUSxFQUFFLENBQUMsRUFBRSxJQUFJLEVBQUUsS0FBSyxFQUFFLEtBQUssRUFBRSxLQUFLLEVBQUUsRUFBRSxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUUsS0FBSyxFQUFFLElBQUksRUFBRSxFQUFFLEVBQUUsSUFBSSxFQUFFLEtBQUssRUFBRSxLQUFLLEVBQUUsS0FBSyxFQUFFLEVBQUUsRUFBRSxJQUFJLEVBQUUsS0FBSyxFQUFFLEtBQUssRUFBRSxLQUFLLEVBQUUsRUFBQyxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUUsS0FBSyxFQUFFLElBQUksRUFBRSxDQUFnQjtRQUMvSyxRQUFRLEVBQUUsRUFBRTtRQUNaLFNBQVMsRUFBRSxFQUFpQjtRQUM1QixXQUFXLEVBQUUsSUFBSSxHQUFHLEVBQWdDO1FBQ3BELFdBQVcsRUFBRSxFQUFFO1FBQ2YsWUFBWSxFQUFFLEVBQWlCO1FBQy9CLEdBQUcsRUFBRSxDQUFDO0tBQ1A7SUFLRCxNQUFNLEVBQUU7UUFDTixJQUFJLENBQUMsYUFBYSxFQUFFLENBQUE7SUFDdEIsQ0FBQztJQUdELEtBQUssQ0FBQyxhQUFhO1FBQ2pCLE1BQU0sRUFBRSxJQUFJLEVBQUUsR0FBRyxNQUFNLGFBQUcsQ0FBQyxXQUFXLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxPQUFPLENBQUMsQ0FBQTtRQUN6RCxNQUFNLFNBQVMsR0FBRyxJQUFJLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsQ0FBQyxFQUFFLElBQUksRUFBRSxFQUFFLENBQUMsUUFBUSxFQUFFLEtBQUssRUFB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QUFFO2lCQUNSLENBQUMsQ0FBQTthQUNIO1NBQ0Y7SUFDSCxDQUFDO0lBTUQsT0FBTyxFQUFFO0lBRVQsQ0FBQztJQUtELE1BQU0sRUFBRTtJQUVSLENBQUM7SUFLRCxNQUFNLEVBQUU7SUFFUixDQUFDO0lBS0QsUUFBUSxFQUFFO0lBRVYsQ0FBQztJQUtELGlCQUFpQixFQUFFO0lBRW5CLENBQUM7SUFLRCxhQUFhLEVBQUU7SUFFZixDQUFDO0lBS0QsaUJBQWlCLEVBQUU7SUFFbkIsQ0FBQztDQUNGLENBQUMsQ0FBQSIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBhcGkgZnJvbSBcIi4uLy4uLy4uL3V0aWxzL2FwaVwiXG5cbi8vIG1pbmlwcm9ncmFtL3BhZ2VzL2FkbWluL3JlZ2lzdGVyRGV2L3JlZ2lzdGVyRGV2LmpzXG5pbnRlcmZhY2UgZGV2TW9kYWxzIHtcbiAgdGV4dDogc3RyaW5nLFxuICB2YWx1ZTogc3RyaW5nXG59XG5cblxuUGFnZSh7XG5cbiAgLyoqXG4gICAqIOmhtemdoueahOWIneWni+aVsOaNrlxuICAgKi9cbiAgZGF0YToge1xuICAgIGlkOiAnJyxcbiAgICBpZHM6IFtdIGFzIHN0cmluZ1tdLFxuICAgIGRldlR5cGU6ICdVUFMnLFxuICAgIGRldlR5cGVzOiBbeyB0ZXh0OiAnVVBTJywgdmFsdWU6ICdVUFMnIH0sIHsgdGV4dDogJ+epuuiwgycsIHZhbHVlOiAn56m66LCDJyB9LCB7IHRleHQ6ICfnlLXph4/ku6onLCB2YWx1ZTogJ+eUtemHj+S7qicgfSwgeyB0ZXh0OiAn5rip5rm/5bqmJywgdmFsdWU6ICfmuKnmub/luqYnIH0seyB0ZXh0OiAnSU8nLCB2YWx1ZTogJ0lPJyB9XSBhcyBkZXZNb2RhbHNbXSxcbiAgICBkZXZNb2RhbDogJycsXG4gICAgZGV2TW9kYWxzOiBbXSBhcyBkZXZNb2RhbHNbXSxcbiAgICBkZXZNb2Rlc01hcDogbmV3IE1hcCgpIGFzIE1hcDxzdHJpbmcsIFVhcnQuRGV2c1R5cGU+LFxuICAgIGRldlByb3RvY29sOiAnJyxcbiAgICBkZXZQcm90b2NvbHM6IFtdIGFzIGRldk1vZGFsc1tdLFxuICAgIHBpZDogMVxuICB9LFxuXG4gIC8qKlxuICAgKiDnlJ/lkb3lkajmnJ/lh73mlbAtLeebkeWQrOmhtemdouWKoOi9vVxuICAgKi9cbiAgb25Mb2FkOiBmdW5jdGlvbiAoKSB7XG4gICAgdGhpcy5kZXZUeXBlQ2hhbmdlKClcbiAgfSxcblxuICAvLyDnm5HlkKzorr7lpIfnsbvlnovlj5jljJZcbiAgYXN5bmMgZGV2VHlwZUNoYW5nZSgpIHtcbiAgICBjb25zdCB7IGRhdGEgfSA9IGF3YWl0IGFwaS5nZXREZXZUeXBlcyh0aGlzLmRhdGEuZGV2VHlwZSlcbiAgICBjb25zdCBkZXZNb2RhbHMgPSBkYXRhLm1hcChlbCA9PiAoeyB0ZXh0OiBlbC5EZXZNb2RlbCwgdmFsdWU6IGVsLkRldk1vZGVsIH0pKVxuICAgIHRoaXMuc2V0RGF0YSh7XG4gICAgICBkZXZNb2RhbHMsXG4gICAgICBkZXZQcm90b2NvbHM6IFtdLFxuICAgICAgZGV2TW9kZXNNYXA6IG5ldyBNYXAoZGF0YS5tYXAoZWwgPT4gW2VsLkRldk1vZGVsLCBlbF0pKVxuICAgIH0pXG4gIH0sXG5cbiAgLy8g55uR5ZCs6K6+5aSH5Z6L5Y+35Y+Y5YyWXG4gIGFzeW5jIGRldk1vZGFsQ2hhbmdlKCkge1xuICAgIGNvbnN0IHsgZGV2TW9kZXNNYXAsIGRldk1vZGFsIH0gPSB0aGlzLmRhdGFcbiAgICBjb25zdCBkZXZQcm90b2NvbHMgPSBkZXZNb2Rlc01hcC5nZXQoZGV2TW9kYWwpPy5Qcm90b2NvbHMubWFwKGVsID0+ICh7IHRleHQ6IGVsLlByb3RvY29sLCB2YWx1ZTogZWwuUHJvdG9jb2wgfSkpIVxuICAgIHRoaXMuc2V0RGF0YSh7XG4gICAgICBkZXZQcm90b2NvbHNcbiAgICB9KVxuICB9LFxuXG4gIC8vIOiwg+eUqOW+ruS/oWFwae+8jOaJq+aPj0RUVeadoeW9oueggVxuICBhc3luYyBzY2FuTWFjKCkge1xuICAgIGNvbnN0IHNjYW5SZXN1bHQgPSBhd2FpdCB3eC5zY2FuQ29kZSh7fSlcbiAgICB0aGlzLnNldERhdGEoe1xuICAgICAgaWQ6IHNjYW5SZXN1bHQucmVzdWx0XG4gICAgfSlcbiAgICB0aGlzLnNjYW5SZXF1c3QoKVxuICB9LFxuXG4gIGFzeW5jIHNjYW5SZXF1c3QoKSB7XG4gICAgd3guc2hvd0xvYWRpbmcoeyB0aXRsZTogJ+afpeivouS4rScgfSlcbiAgICBjb25zdCByID0gYXdhaXQgYXBpLmdldFJlZ2lzdGVyRGV2KHRoaXMuZGF0YS5pZClcbiAgICB3eC5oaWRlTG9hZGluZygpXG4gICAgaWYgKHIuY29kZSAmJiByLmRhdGEpIHtcbiAgICAgIHd4LnNob3dNb2RhbCh7XG4gICAgICAgIHRpdGxlOiAn6YeN5aSN5rOo5YaMJyxcbiAgICAgICAgY29udGVudDogYOiuvuWkhyR7ci5kYXRhLmlkfS8ke3IuZGF0YS5tb3VudERldn3lt7Looqvms6jlhoxgXG4gICAgICB9KVxuICAgIH0gZWxzZVxuICAgICAgdGhpcy5zZXREYXRhKHtcbiAgICAgICAgaWRzOiBbLi4ubmV3IFNldChbLi4udGhpcy5kYXRhLmlkcywgdGhpcy5kYXRhLmlkXSldXG4gICAgICB9KVxuICB9LFxuXG5cbiAgLy8g5Yig6Zmk6YCJ5oup55qERFRVXG4gIHJtaWQoZXZlbnQ6IHZhbnRFdmVudCkge1xuICAgIGNvbnN0IG1hYyA9IGV2ZW50LmN1cnJlbnRUYXJnZXQuZGF0YXNldC5rZXlcbiAgICB3eC5zaG93TW9kYWwoe1xuICAgICAgdGl0bGU6ICfliKDpmaRJZCcsXG4gICAgICBjb250ZW50OiBg56Gu5a6a5Yig6ZmkSWQ6JHttYWN9ID8/YCxcbiAgICAgIHN1Y2Nlc3M6IChyZXMpID0+IHtcbiAgICAgICAgaWYgKHJlcy5jb25maXJtKSB7XG4gICAgICAgICAgdGhpcy5zZXREYXRhKHtcbiAgICAgICAgICAgIGlkczogdGhpcy5kYXRhLmlkcy5maWx0ZXIoZWwgPT4gZWwgIT09IG1hYylcbiAgICAgICAgICB9KVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfSlcbiAgfSxcbiAgLy8g5o+Q5LqkXG4gIGFzeW5jIHN1Ym1pdCgpIHtcbiAgICBjb25zdCB7IGlkcywgcGlkLCBkZXZNb2RhbCwgZGV2UHJvdG9jb2wsIGRldlR5cGUgfSA9IHRoaXMuZGF0YVxuICAgIGlmIChpZHMubGVuZ3RoID09PSAwIHx8ICFwaWQgfHwgIWRldlByb3RvY29sIHx8ICFkZXZNb2RhbCB8fCAhZGV2VHlwZSkge1xuICAgICAgd3guc2hvd01vZGFsKHtcbiAgICAgICAgdGl0bGU6ICfmoKHpqozplJnor68nLFxuICAgICAgICBjb250ZW50OiBcIue8uuWwkeWPguaVsFwiXG4gICAgICB9KVxuICAgICAgcmV0dXJuXG4gICAgfVxuICAgIGNvbnN0IG1vdW50RGV2OiBVYXJ0LlRlcm1pbmFsTW91bnREZXZzID0ge1xuICAgICAgVHlwZTogZGV2VHlwZSxcbiAgICAgIG1vdW50RGV2OiBkZXZNb2RhbCxcbiAgICAgIHBpZCxcbiAgICAgIHByb3RvY29sOiBkZXZQcm90b2NvbFxuICAgIH1cblxuICAgIGNvbnN0IHJlcyA9IGF3YWl0IHd4LnNob3dNb2RhbCh7XG4gICAgICB0aXRsZTogJ+eZu+iusOiuvuWkhycsXG4gICAgICBjb250ZW50OiBg56Gu6K6k5Y+C5pWwWyR7bW91bnREZXYubW91bnREZXZ9XS9bJHttb3VudERldi5wcm90b2NvbH1dL1ske21vdW50RGV2LnBpZH1dICEhIWBcbiAgICB9KVxuICAgIGlmIChyZXMuY29uZmlybSkge1xuICAgICAgd3guc2hvd0xvYWRpbmcoeyB0aXRsZTogJ+ato+WcqOeZu+iusCcgfSlcbiAgICAgIGNvbnN0IHIgPSBhd2FpdCBhcGkuYWRkUmVnaXN0ZXJEZXYoaWRzLCBtb3VudERldilcbiAgICAgIHd4LmhpZGVMb2FkaW5nKClcbiAgICAgIGlmIChyLmNvZGUpIHtcbiAgICAgICAgd3guc2hvd01vZGFsKHtcbiAgICAgICAgICB0aXRsZTogJ3N1Y2Nlc3MnLFxuICAgICAgICAgIGNvbnRlbnQ6IGDmiJDlip/ms6jlhozorr7lpIcke3IuZGF0YS5sZW5ndGh95LiqYFxuICAgICAgICB9KVxuICAgICAgICB0aGlzLnNldERhdGEoe1xuICAgICAgICAgIGlkOiAnJyxcbiAgICAgICAgICBpZHM6IFtdXG4gICAgICAgIH0pXG4gICAgICB9XG4gICAgfVxuICB9LFxuXG5cbiAgLyoqXG4gICAqIOeUn+WRveWRqOacn+WHveaVsC0t55uR5ZCs6aG16Z2i5Yid5qyh5riy5p+T5a6M5oiQXG4gICAqL1xuICBvblJlYWR5OiBmdW5jdGlvbiAoKSB7XG5cbiAgfSxcblxuICAvKipcbiAgICog55Sf5ZG95ZGo5pyf5Ye95pWwLS3nm5HlkKzpobXpnaLmmL7npLpcbiAgICovXG4gIG9uU2hvdzogZnVuY3Rpb24gKCkge1xuXG4gIH0sXG5cbiAgLyoqXG4gICAqIOeUn+WRveWRqOacn+WHveaVsC0t55uR5ZCs6aG16Z2i6ZqQ6JePXG4gICAqL1xuICBvbkhpZGU6IGZ1bmN0aW9uICgpIHtcblxuICB9LFxuXG4gIC8qKlxuICAgKiDnlJ/lkb3lkajmnJ/lh73mlbAtLeebkeWQrOmhtemdouWNuOi9vVxuICAgKi9cbiAgb25VbmxvYWQ6IGZ1bmN0aW9uICgpIHtcblxuICB9LFxuXG4gIC8qKlxuICAgKiDpobXpnaLnm7jlhbPkuovku7blpITnkIblh73mlbAtLeebkeWQrOeUqOaIt+S4i+aLieWKqOS9nFxuICAgKi9cbiAgb25QdWxsRG93blJlZnJlc2g6IGZ1bmN0aW9uICgpIHtcblxuICB9LFxuXG4gIC8qKlxuICAgKiDpobXpnaLkuIrmi4nop6blupXkuovku7bnmoTlpITnkIblh73mlbBcbiAgICovXG4gIG9uUmVhY2hCb3R0b206IGZ1bmN0aW9uICgpIHtcblxuICB9LFxuXG4gIC8qKlxuICAgKiDnlKjmiLfngrnlh7vlj7PkuIrop5LliIbkuqtcbiAgICovXG4gIG9uU2hhcmVBcHBNZXNzYWdlOiBmdW5jdGlvbiAoKSB7XG5cbiAgfVxufSkiXX0=