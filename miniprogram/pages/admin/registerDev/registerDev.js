"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const api_1 = require("../../../utils/api");
Page({
    data: {
        id: '',
        ids: [],
        devType: 'UPS',
        devTypes: [{ text: 'UPS', value: 'UPS' }, { text: '空调', value: '空调' }, { text: '电量仪', value: '电量仪' }, { text: '温湿度', value: '温湿度' }, { text: 'IO', value: 'IO' }],
        devModal: '',
        devModals: [],
        devModesMap: new Map(),
        devProtocol: '',
        devProtocols: [],
        pid: 1
    },
    onLoad: function () {
        this.devTypeChange();
    },
    async devTypeChange() {
        const { data } = await api_1.default.getDevTypes(this.data.devType);
        const devModals = data.map(el => ({ text: el.DevModel, value: el.DevModel }));
        this.setData({
            devModals,
            devProtocols: [],
            devModesMap: new Map(data.map(el => [el.DevModel, el]))
        });
    },
    async devModalChange() {
        const { devModesMap, devModal } = this.data;
        const devProtocols = devModesMap.get(devModal)?.Protocols.map(el => ({ text: el.Protocol, value: el.Protocol }));
        this.setData({
            devProtocols
        });
    },
    async scanMac() {
        const scanResult = await wx.scanCode({});
        this.setData({
            id: scanResult.result
        });
        this.scanRequst();
    },
    async scanRequst() {
        wx.showLoading({ title: '查询中' });
        const r = await api_1.default.getRegisterDev(this.data.id);
        wx.hideLoading();
        if (r.code && r.data) {
            wx.showModal({
                title: '重复注册',
                content: `设备${r.data.id}/${r.data.mountDev}已被注册`
            });
        }
        else
            this.setData({
                ids: [...new Set([...this.data.ids, this.data.id])]
            });
    },
    rmid(event) {
        const mac = event.currentTarget.dataset.key;
        wx.showModal({
            title: '删除Id',
            content: `确定删除Id:${mac} ??`,
            success: (res) => {
                if (res.confirm) {
                    this.setData({
                        ids: this.data.ids.filter(el => el !== mac)
                    });
                }
            }
        });
    },
    async submit() {
        const { ids, pid, devModal, devProtocol, devType } = this.data;
        if (ids.length === 0 || !pid || !devProtocol || !devModal || !devType) {
            wx.showModal({
                title: '校验错误',
                content: "缺少参数"
            });
            return;
        }
        const mountDev = {
            Type: devType,
            mountDev: devModal,
            pid,
            protocol: devProtocol
        };
        const res = await wx.showModal({
            title: '登记设备',
            content: `确认参数[${mountDev.mountDev}]/[${mountDev.protocol}]/[${mountDev.pid}] !!!`
        });
        if (res.confirm) {
            wx.showLoading({ title: '正在登记' });
            const r = await api_1.default.addRegisterDev(ids, mountDev);
            wx.hideLoading();
            if (r.code) {
                wx.showModal({
                    title: 'success',
                    content: `成功注册设备${r.data.length}个`
                });
                this.setData({
                    id: '',
                    ids: []
                });
            }
        }
    },
    onReady: function () {
    },
    onShow: function () {
    },
    onHide: function () {
    },
    onUnload: function () {
    },
    onPullDownRefresh: function () {
    },
    onReachBottom: function () {
    },
    onShareAppMessage: function () {
    }
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicmVnaXN0ZXJEZXYuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJyZWdpc3RlckRldi50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUFBLDRDQUFvQztBQVNwQyxJQUFJLENBQUM7SUFLSCxJQUFJLEVBQUU7UUFDSixFQUFFLEVBQUUsRUFBRTtRQUNOLEdBQUcsRUFBRSxFQUFjO1FBQ25CLE9BQU8sRUFBRSxLQUFLO1FBQ2QsUUFBUSxFQUFFLENBQUMsRUFBRSxJQUFJLEVBQUUsS0FBSyxFQUFFLEtBQUssRUFBRSxLQUFLLEVBQUUsRUFBRSxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUUsS0FBSyxFQUFFLElBQUksRUFBRSxFQUFFLEVBQUUsSUFBSSxFQUFFLEtBQUssRUFBRSxLQUFLLEVBQUUsS0FBSyxFQUFFLEVBQUUsRUFBRSxJQUFJLEVBQUUsS0FBSyxFQUFFLEtBQUssRUFBRSxLQUFLLEVBQUUsRUFBQyxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUUsS0FBSyxFQUFFLElBQUksRUFBRSxDQUFnQjtRQUMvSyxRQUFRLEVBQUUsRUFBRTtRQUNaLFNBQVMsRUFBRSxFQUFpQjtRQUM1QixXQUFXLEVBQUUsSUFBSSxHQUFHLEVBQWdDO1FBQ3BELFdBQVcsRUFBRSxFQUFFO1FBQ2YsWUFBWSxFQUFFLEVBQWlCO1FBQy9CLEdBQUcsRUFBRSxDQUFDO0tBQ1A7SUFLRCxNQUFNLEVBQUU7UUFDTixJQUFJLENBQUMsYUFBYSxFQUFFLENBQUE7SUFDdEIsQ0FBQztJQUdELEtBQUssQ0FBQyxhQUFhO1FBQ2pCLE1BQU0sRUFBRSxJQUFJLEVBQUUsR0FBRyxNQUFNLGFBQUcsQ0FBQyxXQUFXLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxPQUFPLENBQUMsQ0FBQTtRQUN6RCxNQUFNLFNBQVMsR0FBRyxJQUFJLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsQ0FBQyxFQUFFLElBQUksRUFBRSxFQUFFLENBQUMsUUFBUSxFQUFFLEtBQUssRUFB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QUFDO29CQUNYLEVBQUUsRUFBRSxFQUFFO29CQUNOLEdBQUcsRUFBRSxFQUFFO2lCQUNSLENBQUMsQ0FBQTtZQUNKLENBQUM7UUFDSCxDQUFDO0lBQ0gsQ0FBQztJQU1ELE9BQU8sRUFBRTtJQUVULENBQUM7SUFLRCxNQUFNLEVBQUU7SUFFUixDQUFDO0lBS0QsTUFBTSxFQUFFO0lBRVIsQ0FBQztJQUtELFFBQVEsRUFBRTtJQUVWLENBQUM7SUFLRCxpQkFBaUIsRUFBRTtJQUVuQixDQUFDO0lBS0QsYUFBYSxFQUFFO0lBRWYsQ0FBQztJQUtELGlCQUFpQixFQUFFO0lBRW5CLENBQUM7Q0FDRixDQUFDLENBQUEiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgYXBpIGZyb20gXCIuLi8uLi8uLi91dGlscy9hcGlcIlxuXG4vLyBtaW5pcHJvZ3JhbS9wYWdlcy9hZG1pbi9yZWdpc3RlckRldi9yZWdpc3RlckRldi5qc1xuaW50ZXJmYWNlIGRldk1vZGFscyB7XG4gIHRleHQ6IHN0cmluZyxcbiAgdmFsdWU6IHN0cmluZ1xufVxuXG5cblBhZ2Uoe1xuXG4gIC8qKlxuICAgKiDpobXpnaLnmoTliJ3lp4vmlbDmja5cbiAgICovXG4gIGRhdGE6IHtcbiAgICBpZDogJycsXG4gICAgaWRzOiBbXSBhcyBzdHJpbmdbXSxcbiAgICBkZXZUeXBlOiAnVVBTJyxcbiAgICBkZXZUeXBlczogW3sgdGV4dDogJ1VQUycsIHZhbHVlOiAnVVBTJyB9LCB7IHRleHQ6ICfnqbrosIMnLCB2YWx1ZTogJ+epuuiwgycgfSwgeyB0ZXh0OiAn55S16YeP5LuqJywgdmFsdWU6ICfnlLXph4/ku6onIH0sIHsgdGV4dDogJ+a4qea5v+W6picsIHZhbHVlOiAn5rip5rm/5bqmJyB9LHsgdGV4dDogJ0lPJywgdmFsdWU6ICdJTycgfV0gYXMgZGV2TW9kYWxzW10sXG4gICAgZGV2TW9kYWw6ICcnLFxuICAgIGRldk1vZGFsczogW10gYXMgZGV2TW9kYWxzW10sXG4gICAgZGV2TW9kZXNNYXA6IG5ldyBNYXAoKSBhcyBNYXA8c3RyaW5nLCBVYXJ0LkRldnNUeXBlPixcbiAgICBkZXZQcm90b2NvbDogJycsXG4gICAgZGV2UHJvdG9jb2xzOiBbXSBhcyBkZXZNb2RhbHNbXSxcbiAgICBwaWQ6IDFcbiAgfSxcblxuICAvKipcbiAgICog55Sf5ZG95ZGo5pyf5Ye95pWwLS3nm5HlkKzpobXpnaLliqDovb1cbiAgICovXG4gIG9uTG9hZDogZnVuY3Rpb24gKCkge1xuICAgIHRoaXMuZGV2VHlwZUNoYW5nZSgpXG4gIH0sXG5cbiAgLy8g55uR5ZCs6K6+5aSH57G75Z6L5Y+Y5YyWXG4gIGFzeW5jIGRldlR5cGVDaGFuZ2UoKSB7XG4gICAgY29uc3QgeyBkYXRhIH0gPSBhd2FpdCBhcGkuZ2V0RGV2VHlwZXModGhpcy5kYXRhLmRldlR5cGUpXG4gICAgY29uc3QgZGV2TW9kYWxzID0gZGF0YS5tYXAoZWwgPT4gKHsgdGV4dDogZWwuRGV2TW9kZWwsIHZhbHVlOiBlbC5EZXZNb2RlbCB9KSlcbiAgICB0aGlzLnNldERhdGEoe1xuICAgICAgZGV2TW9kYWxzLFxuICAgICAgZGV2UHJvdG9jb2xzOiBbXSxcbiAgICAgIGRldk1vZGVzTWFwOiBuZXcgTWFwKGRhdGEubWFwKGVsID0+IFtlbC5EZXZNb2RlbCwgZWxdKSlcbiAgICB9KVxuICB9LFxuXG4gIC8vIOebkeWQrOiuvuWkh+Wei+WPt+WPmOWMllxuICBhc3luYyBkZXZNb2RhbENoYW5nZSgpIHtcbiAgICBjb25zdCB7IGRldk1vZGVzTWFwLCBkZXZNb2RhbCB9ID0gdGhpcy5kYXRhXG4gICAgY29uc3QgZGV2UHJvdG9jb2xzID0gZGV2TW9kZXNNYXAuZ2V0KGRldk1vZGFsKT8uUHJvdG9jb2xzLm1hcChlbCA9PiAoeyB0ZXh0OiBlbC5Qcm90b2NvbCwgdmFsdWU6IGVsLlByb3RvY29sIH0pKSFcbiAgICB0aGlzLnNldERhdGEoe1xuICAgICAgZGV2UHJvdG9jb2xzXG4gICAgfSlcbiAgfSxcblxuICAvLyDosIPnlKjlvq7kv6FhcGnvvIzmiavmj49EVFXmnaHlvaLnoIFcbiAgYXN5bmMgc2Nhbk1hYygpIHtcbiAgICBjb25zdCBzY2FuUmVzdWx0ID0gYXdhaXQgd3guc2NhbkNvZGUoe30pXG4gICAgdGhpcy5zZXREYXRhKHtcbiAgICAgIGlkOiBzY2FuUmVzdWx0LnJlc3VsdFxuICAgIH0pXG4gICAgdGhpcy5zY2FuUmVxdXN0KClcbiAgfSxcblxuICBhc3luYyBzY2FuUmVxdXN0KCkge1xuICAgIHd4LnNob3dMb2FkaW5nKHsgdGl0bGU6ICfmn6Xor6LkuK0nIH0pXG4gICAgY29uc3QgciA9IGF3YWl0IGFwaS5nZXRSZWdpc3RlckRldih0aGlzLmRhdGEuaWQpXG4gICAgd3guaGlkZUxvYWRpbmcoKVxuICAgIGlmIChyLmNvZGUgJiYgci5kYXRhKSB7XG4gICAgICB3eC5zaG93TW9kYWwoe1xuICAgICAgICB0aXRsZTogJ+mHjeWkjeazqOWGjCcsXG4gICAgICAgIGNvbnRlbnQ6IGDorr7lpIcke3IuZGF0YS5pZH0vJHtyLmRhdGEubW91bnREZXZ95bey6KKr5rOo5YaMYFxuICAgICAgfSlcbiAgICB9IGVsc2VcbiAgICAgIHRoaXMuc2V0RGF0YSh7XG4gICAgICAgIGlkczogWy4uLm5ldyBTZXQoWy4uLnRoaXMuZGF0YS5pZHMsIHRoaXMuZGF0YS5pZF0pXVxuICAgICAgfSlcbiAgfSxcblxuXG4gIC8vIOWIoOmZpOmAieaLqeeahERUVVxuICBybWlkKGV2ZW50OiB2YW50RXZlbnQpIHtcbiAgICBjb25zdCBtYWMgPSBldmVudC5jdXJyZW50VGFyZ2V0LmRhdGFzZXQua2V5XG4gICAgd3guc2hvd01vZGFsKHtcbiAgICAgIHRpdGxlOiAn5Yig6ZmkSWQnLFxuICAgICAgY29udGVudDogYOehruWumuWIoOmZpElkOiR7bWFjfSA/P2AsXG4gICAgICBzdWNjZXNzOiAocmVzKSA9PiB7XG4gICAgICAgIGlmIChyZXMuY29uZmlybSkge1xuICAgICAgICAgIHRoaXMuc2V0RGF0YSh7XG4gICAgICAgICAgICBpZHM6IHRoaXMuZGF0YS5pZHMuZmlsdGVyKGVsID0+IGVsICE9PSBtYWMpXG4gICAgICAgICAgfSlcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0pXG4gIH0sXG4gIC8vIOaPkOS6pFxuICBhc3luYyBzdWJtaXQoKSB7XG4gICAgY29uc3QgeyBpZHMsIHBpZCwgZGV2TW9kYWwsIGRldlByb3RvY29sLCBkZXZUeXBlIH0gPSB0aGlzLmRhdGFcbiAgICBpZiAoaWRzLmxlbmd0aCA9PT0gMCB8fCAhcGlkIHx8ICFkZXZQcm90b2NvbCB8fCAhZGV2TW9kYWwgfHwgIWRldlR5cGUpIHtcbiAgICAgIHd4LnNob3dNb2RhbCh7XG4gICAgICAgIHRpdGxlOiAn5qCh6aqM6ZSZ6K+vJyxcbiAgICAgICAgY29udGVudDogXCLnvLrlsJHlj4LmlbBcIlxuICAgICAgfSlcbiAgICAgIHJldHVyblxuICAgIH1cbiAgICBjb25zdCBtb3VudERldjogVWFydC5UZXJtaW5hbE1vdW50RGV2cyA9IHtcbiAgICAgIFR5cGU6IGRldlR5cGUsXG4gICAgICBtb3VudERldjogZGV2TW9kYWwsXG4gICAgICBwaWQsXG4gICAgICBwcm90b2NvbDogZGV2UHJvdG9jb2xcbiAgICB9XG5cbiAgICBjb25zdCByZXMgPSBhd2FpdCB3eC5zaG93TW9kYWwoe1xuICAgICAgdGl0bGU6ICfnmbvorrDorr7lpIcnLFxuICAgICAgY29udGVudDogYOehruiupOWPguaVsFske21vdW50RGV2Lm1vdW50RGV2fV0vWyR7bW91bnREZXYucHJvdG9jb2x9XS9bJHttb3VudERldi5waWR9XSAhISFgXG4gICAgfSlcbiAgICBpZiAocmVzLmNvbmZpcm0pIHtcbiAgICAgIHd4LnNob3dMb2FkaW5nKHsgdGl0bGU6ICfmraPlnKjnmbvorrAnIH0pXG4gICAgICBjb25zdCByID0gYXdhaXQgYXBpLmFkZFJlZ2lzdGVyRGV2KGlkcywgbW91bnREZXYpXG4gICAgICB3eC5oaWRlTG9hZGluZygpXG4gICAgICBpZiAoci5jb2RlKSB7XG4gICAgICAgIHd4LnNob3dNb2RhbCh7XG4gICAgICAgICAgdGl0bGU6ICdzdWNjZXNzJyxcbiAgICAgICAgICBjb250ZW50OiBg5oiQ5Yqf5rOo5YaM6K6+5aSHJHtyLmRhdGEubGVuZ3RofeS4qmBcbiAgICAgICAgfSlcbiAgICAgICAgdGhpcy5zZXREYXRhKHtcbiAgICAgICAgICBpZDogJycsXG4gICAgICAgICAgaWRzOiBbXVxuICAgICAgICB9KVxuICAgICAgfVxuICAgIH1cbiAgfSxcblxuXG4gIC8qKlxuICAgKiDnlJ/lkb3lkajmnJ/lh73mlbAtLeebkeWQrOmhtemdouWIneasoea4suafk+WujOaIkFxuICAgKi9cbiAgb25SZWFkeTogZnVuY3Rpb24gKCkge1xuXG4gIH0sXG5cbiAgLyoqXG4gICAqIOeUn+WRveWRqOacn+WHveaVsC0t55uR5ZCs6aG16Z2i5pi+56S6XG4gICAqL1xuICBvblNob3c6IGZ1bmN0aW9uICgpIHtcblxuICB9LFxuXG4gIC8qKlxuICAgKiDnlJ/lkb3lkajmnJ/lh73mlbAtLeebkeWQrOmhtemdoumakOiXj1xuICAgKi9cbiAgb25IaWRlOiBmdW5jdGlvbiAoKSB7XG5cbiAgfSxcblxuICAvKipcbiAgICog55Sf5ZG95ZGo5pyf5Ye95pWwLS3nm5HlkKzpobXpnaLljbjovb1cbiAgICovXG4gIG9uVW5sb2FkOiBmdW5jdGlvbiAoKSB7XG5cbiAgfSxcblxuICAvKipcbiAgICog6aG16Z2i55u45YWz5LqL5Lu25aSE55CG5Ye95pWwLS3nm5HlkKznlKjmiLfkuIvmi4nliqjkvZxcbiAgICovXG4gIG9uUHVsbERvd25SZWZyZXNoOiBmdW5jdGlvbiAoKSB7XG5cbiAgfSxcblxuICAvKipcbiAgICog6aG16Z2i5LiK5ouJ6Kem5bqV5LqL5Lu255qE5aSE55CG5Ye95pWwXG4gICAqL1xuICBvblJlYWNoQm90dG9tOiBmdW5jdGlvbiAoKSB7XG5cbiAgfSxcblxuICAvKipcbiAgICog55So5oi354K55Ye75Y+z5LiK6KeS5YiG5LqrXG4gICAqL1xuICBvblNoYXJlQXBwTWVzc2FnZTogZnVuY3Rpb24gKCkge1xuXG4gIH1cbn0pIl19